<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2018-12-20">
<title>Benchmarking the maxLik function â€“ Amalan Mahendran</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Amalan Mahendran</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../publication/index.html"> 
<span class="menu-text">Publication and Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/index.html"> 
<span class="menu-text">Blog Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tidytuesday/index.html"> 
<span class="menu-text">#TidyTuesday</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../interests/index.html"> 
<span class="menu-text">Interests</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-socials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Socials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-socials">
<li>
    <a class="dropdown-item" href="https://twitter.com/Amalan_Con_Stat"><i class="bi bi-hash" role="img">
</i> 
 <span class="dropdown-text">Twitter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bsky.app/profile/amalanconstat.bsky.social"><i class="bi bi-twitter" role="img">
</i> 
 <span class="dropdown-text">BlueSky</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/Amalan-ConStat"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/amalan-mahendran-72b86b37/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="dropdown-text">LinkedIn</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://scholar.google.com/citations?user=fj4E-GMAAAAJ&amp;hl=en"><i class="bi bi-google" role="img">
</i> 
 <span class="dropdown-text">Google Scholar</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.researchgate.net/profile/Amalan_Mahendran"><i class="bi bi-r-square-fill" role="img">
</i> 
 <span class="dropdown-text">Researchgate</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://amalan-constat.r-universe.dev/builds"><i class="bi bi-box-fill" role="img">
</i> 
 <span class="dropdown-text">R Universe</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="mailto:mail.amalan0595@gmail.com"><i class="bi bi-mailbox" role="img">
</i> 
 <span class="dropdown-text">Email Me</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Benchmarking the maxLik function</h1>
  <div class="quarto-categories">
    <div class="quarto-category">BetaBinomial</div>
    <div class="quarto-category">fitODBOD</div>
    <div class="quarto-category">maxLik</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 20, 2018</p>
    </div>
  </div>
  
    
  </div>
  


</header><p><strong>NOTE : Below post is valid for Package version 1.4.0 and Before. </strong></p>
<section id="estimating-the-shape-parameters-of-beta-binomial-distribution" class="level1"><h1>Estimating the shape parameters of Beta-Binomial Distribution</h1>
</section><section id="introduction" class="level1"><h1>Introduction</h1>
<p>Beginning of this month I wrote a <a href="https://amalan-con-stat.netlify.com/post/fitodbod_1/benchmarking-maximum-liklihood-functions-from-r/#maxlik-function">small section</a> regarding maxLik function by comparing it to other optimization functions. Here, we will further study the analytical methods which can be used in this function and compare them to find suitability. maxLik function is from the package <a href="https://cran.r-project.org/web/packages/maxLik/index.html">maxLik</a>. Further, <a href="https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxLik">Documentation</a> clearly indicates all things related to the function in detail.</p>
<p>Focusing on the seven analytical methods is my intention from this blog post. So, we have the Beta-Binomial distribution and Binomial Outcome data, and need to estimate proper shape parameters which would Maximize the Log Likelihood value of the Beta-Binomial distribution for the Alcohol Consumption data. In this case Alcohol Consumption data from the <a href="https://cran.r-project.org/package=fitODBOD">fitODBOD</a> package will be used.</p>
<p>Further we will focus on the process time to optimization, estimated shape parameters, maximized Log Likelihood value, expected frequencies, p-value and Over-dispersion with tables.</p>
<p>Below are the seven analytical methods in concern</p>
<ol type="1">
<li>NR</li>
<li>BFGS</li>
<li>BFGSR</li>
<li>BHHH</li>
<li>SANN</li>
<li>CG</li>
<li>NM</li>
</ol>
<p>Alcohol Consumption data has two sets of frequency values but only values from week 1 will be used. Below is the the Alcohol Consumption data, where number of observations is 399 and the Binomial Random variable is a vector of values from zero to seven.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Amalan-ConStat/fitODBOD">fitODBOD</a></span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">Alcohol_data</span>,<span class="st">"html"</span>,align<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span><span class="op">)</span>,font_size <span class="op">=</span> <span class="fl">14</span>,full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>,color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">1</span>,color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">Days</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">week1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">week2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center; color: red !important;">0</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">42</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">1</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">47</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">2</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">54</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">3</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">4</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">49</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">5</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">6</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">43</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">7</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">84</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="brief-of-maxlik-function" class="level2"><h2 class="anchored" data-anchor-id="brief-of-maxlik-function">Brief of maxLik Function</h2>
<p>Small <a href="https://amalan-con-stat.netlify.com/post/fitodbod_1/benchmarking-maximum-liklihood-functions-from-r/#maxlik-function">section</a> about the maxLik function will be very useful to understand this blog post.</p>
<p>Reference : Henningsen, A. and Toomet, O. (2011): maxLik: A package for maximum likelihood estimation in R Computational Statistics 26, 443â€“458 Marquardt, D.W., (1963)</p>
<p>An Algorithm for Least-Squares Estimation of Nonlinear Parameters, Journal of the Society for Industrial &amp; Applied Mathematics 11, 2, 431â€“441</p>
<p>So for the initial parameters of a=0.1 and b=0.2 we will be finding estimated parameters from different analytical methods which would maximize the Log Likelihood value of the Beta-Binomial distribution.</p>
<p>First we are transforming the given EstMLEBetaBin function to satisfy the maxLik function conditions.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># new function to facilitate maxLik criteria</span></span>
<span><span class="co"># only one input but has two elements</span></span>
<span><span class="va">formaxLik</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>  <span class="op">-</span><span class="fu">EstMLEBetaBin</span><span class="op">(</span>x<span class="op">=</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>, freq<span class="op">=</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,a<span class="op">=</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,b<span class="op">=</span><span class="va">a</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So the formaxLik function can be used as above and parameters are estimated for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (or a, b) for the Alcohol Consumption data week 1. Further the maxLik function can be scrutinized as below.</p>
<ul>
<li>package : maxLik</li>
<li>No of Inputs: 6</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list or class of maxim or class of maxLik</li>
<li>No of outputs: 11</li>
<li>No of Analytical Methods : 7</li>
<li>Default Method : Automatically chosen</li>
</ul></section><section id="nr-method" class="level2"><h2 class="anchored" data-anchor-id="nr-method">NR method</h2>
<p>NR is an abbreviation for Unconstrained and equality-constrained maximization based on the quadratic approximation (Newton) method. The idea of the Newton method is to approximate the function at a given location by a multidimensional quadratic function, and use the estimated maximum as the start value for the next iteration.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maxLik</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># optimizing values for a,b using NR analytical method</span></span>
<span><span class="va">NR_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"NR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">NR_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">NR_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">NR_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">NR_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">NR_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bfgs-method" class="level2"><h2 class="anchored" data-anchor-id="bfgs-method">BFGS method</h2>
<p>BFGS is a Quasi-Newton method (also known as a variable metric algorithm), specifically that published simultaneously in 1970 by Broyden, Fletcher, Goldfarb and Shanno. This uses function values and gradients to build up a picture of the surface to be optimized.</p>
<p>Reference : Broyden, C.G., 1967. Quasi-Newton methods and their application to function minimization. Mathematics of Computation, 21(99), pp.368-381.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># optimizing values for a,b using BFGS analytical method</span></span>
<span><span class="va">BFGS_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">BFGS_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BFGS_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">BFGS_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">BFGS_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">BFGS_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bfgsr-method" class="level2"><h2 class="anchored" data-anchor-id="bfgsr-method">BFGSR method</h2>
<p>Combination of two methods which are Newton-Raphson, BFGS (Broyden 1970, Fletcher 1970, Goldfarb 1970, Shanno 1970).</p>
<p>Reference : Broyden, C.G., 1967. Quasi-Newton methods and their application to function minimization. Mathematics of Computation, 21(99), pp.368-381.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># optimizing values for a,b using BFGSR analytical method</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"BFGSR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">BFGSR_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BFGSR_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">BFGSR_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bhhh-method" class="level2"><h2 class="anchored" data-anchor-id="bhhh-method">BHHH method</h2>
<p>BHHH method (Berndt, Hall, Hall, Hausman 1974). The BHHH (information equality) approximation is only valid for log-likelihood functions. It requires the score (gradient) values by individual observations and hence those must be returned by individual observations by grad or fn. With the complexity of BHHH method I choose not to discuss it here, but a reference is mentioned to anyone who has interest in this analytical method.</p>
<p>Reference : Berndt, E., Hall, B., Hall, R. and Hausman, J. (1974): Estimation and Inference in Nonlinear Structural Models, Annals of Social Measurement 3, 653â€“665.</p>
</section><section id="sann-method" class="level2"><h2 class="anchored" data-anchor-id="sann-method">SANN method</h2>
<p>Method SANN is by default a variant of simulated annealing given in Belisle (1992). Simulated-annealing belongs to the class of stochastic global optimization methods. It uses only function values but is relatively slow. It will also work for non-differential functions. This implementation uses the Metropolis function for the acceptance probability.</p>
<p>By default the next candidate point is generated from a Gaussian Markov kernel with scale proportional to the actual temperature. If a function to generate a new candidate point is given, method SANN can also be used to solve combinatorial optimization problems. Temperatures are decreased according to the logarithmic cooling schedule as given in Belisle (1992, p.890); specifically, the temperature is set to <span class="math inline">\(temp / log(((t-1) %/% tmax)*tmax + exp(1))\)</span>, where <span class="math inline">\(t\)</span> is the current iteration step and temp and tmax are specifiable via control.</p>
<p>Note that the SANN method depends critically on the settings of the control parameters. It is not a general-purpose method but can be very useful in getting to a good value on a very rough surface.</p>
<p>Reference : Belisle, C.J., 1992. Convergence theorems for a class of simulated annealing algorithms on R d.&nbsp;Journal of Applied Probability, 29(4), pp.885-895.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># optimizing values for a,b using SANN analytical method</span></span>
<span><span class="va">SANN_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"SANN"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">SANN_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">SANN_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">SANN_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">SANN_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">SANN_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="cg-method" class="level2"><h2 class="anchored" data-anchor-id="cg-method">CG method</h2>
<p>Method CG is a conjugate gradients method based on that by Fletcher and Reeves (1964) (but with the option of Polak-Ribiere or Beale-Sorenson updates). Conjugate gradient methods will generally be more fragile than the BFGS method, but as they do not store a matrix they may be successful in much larger optimization problems.</p>
<p>Reference : Fletcher, R. and Reeves, C.M., 1964. Function minimization by conjugate gradients. The computer journal, 7(2), pp.149-154.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># optimizing values for a,b using CG analytical method</span></span>
<span><span class="va">CG_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"CG"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">CG_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">CG_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">CG_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">CG_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">CG_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="nm-method" class="level2"><h2 class="anchored" data-anchor-id="nm-method">NM method</h2>
<p>NM is the abbreviation to Nelder and Mead method. According to the documentation it uses only function values and is robust but relatively slow. It will work reasonably well for non-differential functions.</p>
<p>Reference : Nelder, J.A. and Mead, R., 1965. A simplex method for function minimization. The computer journal, 7(4), pp.308-313.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># optimizing values for a,b using NM analytical method</span></span>
<span><span class="va">NM_answer</span><span class="op">&lt;-</span><span class="fu">maxLik</span><span class="op">(</span>logLik <span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"NM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtaining class of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">NM_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># length of output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">NM_answer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the outputs</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># estimated values for a, b</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">maximum</span> <span class="co"># minimized function value </span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">iterations</span>  <span class="co"># no of iterations to succeed</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">gradient</span> <span class="co"># last gradient value which was calculated</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">message</span> <span class="co"># additional information</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># hessian matrix</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">code</span> <span class="co"># indicates successful completion</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">fixed</span> <span class="co"># logical vector indicating which parameters are constants</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">type</span> <span class="co"># type of maximization</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">last.step</span> <span class="co"># list describing the last unsuccessful step</span></span>
<span><span class="va">NM_answer</span><span class="op">$</span><span class="va">control</span> <span class="co"># see the documentation understand</span></span>
<span></span>
<span><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span><span class="fu">fitBetaBin</span><span class="op">(</span><span class="va">Alcohol_data</span><span class="op">$</span><span class="va">Days</span>,<span class="va">Alcohol_data</span><span class="op">$</span><span class="va">week1</span>,</span>
<span>           <span class="va">NM_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">NM_answer</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sumary-of-time-evalutation-for-different-analytical-methods-of-maxlik-function" class="level1"><h1>Sumary of Time evalutation for different Analytical methods of maxLik function</h1>
<p>Below table will compare the system process time for different analytical methods. In order to do this time comparison it is possible to use the <a href="https://www.rdocumentation.org/packages/rbenchmark/versions/1.0.0/topics/benchmark">benchmark</a> function of <a href="https://cran.r-project.org/package=rbenchmark">rbenchmark</a> package. Below mentioned code chunk provides the output in a table form which includes the analytical methods and their respective time values. The estimation process of the parameters where each method has been replicated 1000 times to receive a more accurate table for time values.</p>
<p>Table is in the ascending order for elapsed time column. It is evidently clear that SANN analytical method has taken the most time. Before that the analytical method BFGSR is in 5th place. While NM or Nelder Mead method has taken the least time. This time is calculated for 1000 replications of the function being repeated under same conditions. These times does not only reflect based on analytical method, rather on the Log Likelihood function that needs to be maximized, the data provided, the number of estimated that needs to be estimated, the complexity of the function and finally the computerâ€™s processing power.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://rbenchmark.googlecode.com">rbenchmark</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Results1</span><span class="op">&lt;-</span><span class="fu">benchmark</span><span class="op">(</span></span>
<span>          <span class="st">"NR"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"NR"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          <span class="st">"BFGS"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          <span class="st">"BFGSR"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"BFGSR"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          <span class="st">"SANN"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"SANN"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          <span class="st">"CG"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"CG"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          <span class="st">"NM"</span><span class="op">=</span><span class="op">{</span><span class="fu">maxLik</span><span class="op">(</span>logLik<span class="op">=</span><span class="va">formaxLik</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"NM"</span><span class="op">)</span><span class="op">}</span>,</span>
<span>          replications <span class="op">=</span> <span class="fl">100</span>,</span>
<span>          columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"test"</span>,<span class="st">"replications"</span>,<span class="st">"elapsed"</span>,</span>
<span>                      <span class="st">"relative"</span>,<span class="st">"user.self"</span>,<span class="st">"sys.self"</span><span class="op">)</span>,</span>
<span>          order <span class="op">=</span> <span class="st">'elapsed'</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">Results1</span>,<span class="st">"html"</span>,align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>full_width<span class="op">=</span><span class="cn">T</span>,bootstrap_options<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span><span class="op">)</span>,font_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>,color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">1</span>,color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; color: blue !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">test</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">replications</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">elapsed</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">relative</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">user.self</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">sys.self</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; color: red !important;">6</td>
<td style="text-align: center;">NM</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">1.56</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">2</td>
<td style="text-align: center;">BFGS</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">2.70</td>
<td style="text-align: center;">1.688</td>
<td style="text-align: center;">2.71</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important;">1</td>
<td style="text-align: center;">NR</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">3.28</td>
<td style="text-align: center;">2.050</td>
<td style="text-align: center;">3.25</td>
<td style="text-align: center;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">5</td>
<td style="text-align: center;">CG</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">5.97</td>
<td style="text-align: center;">3.731</td>
<td style="text-align: center;">5.92</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important;">3</td>
<td style="text-align: center;">BFGSR</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">55.99</td>
<td style="text-align: center;">34.994</td>
<td style="text-align: center;">55.73</td>
<td style="text-align: center;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">4</td>
<td style="text-align: center;">SANN</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">156.20</td>
<td style="text-align: center;">97.625</td>
<td style="text-align: center;">155.33</td>
<td style="text-align: center;">0.04</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="summary-of-results-after-using-the-maxlik-function-for-different-analytical-methods" class="level1"><h1>Summary of results after using the maxLik function for different analytical methods</h1>
<p>Estimated the shape parameters a,b pair wise from the analytical methods NR, BFGS, BFGSR, SANN, CG and NM. These estimated parameters will be now used in the fitBetaBin function to find the expected frequencies, p-values and over-dispersion. The above measurements can be used to compare each analytical method for any significance difference.</p>
<p>Comparing p-values it is clear that all analytical methods generate the same value up-to third decimal point. This is not the case in Maximum Log Likelihood value where analytical methods NR, BFGS, CG and NM have obtained the value -813.4571, while BFGSR and SANN have shown -813.4576. Further, Over-dispersion values are similar until third decimal point, but after that there is a clear difference among all six methods.</p>
<p>All of the analytical methods have produced distinct values for estimated shape parameters of a and b. For the shape parameter a, similarity is only until second decimal point, and for shape parameter b, similarity of value is only on first decimal point.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">BinomialRandomVariable</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">Frequency</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">NR</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">BFGS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">BFGSR</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">SANN</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">CG</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">NM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center; color: red !important;">0</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.72</td>
<td style="text-align: center;">54.78</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.61</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">1</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">41.98</td>
<td style="text-align: center;">42.06</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">2</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.85</td>
<td style="text-align: center;">38.93</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.91</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">3</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.47</td>
<td style="text-align: center;">38.55</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">4</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40.06</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">5</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">43.99</td>
<td style="text-align: center;">43.93</td>
<td style="text-align: center;">43.97</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">44</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">6</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.06</td>
<td style="text-align: center;">53.03</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">7</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.8</td>
<td style="text-align: center;">87.98</td>
<td style="text-align: center;">87.76</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.77</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Total No of Observations</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">399.01</td>
<td style="text-align: center;">398.99</td>
<td style="text-align: center;">399.14</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">398.99</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">p-value</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0903</td>
<td style="text-align: center;">0.0902</td>
<td style="text-align: center;">0.0903</td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0902</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Estimated a and b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">a=0.7229428 b=0.5808488</td>
<td style="text-align: center;">a=0.7228919 b=0.5807283</td>
<td style="text-align: center;">a=0.7209896 b=0.5790360</td>
<td style="text-align: center;">a=0.7219066 b=0.5813484</td>
<td style="text-align: center;">a=0.7229403 b=0.5808469</td>
<td style="text-align: center;">a=0.7230707 b=0.5809894</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">Maximum Log Likelihood</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-813.4571</td>
<td style="text-align: center;">-813.4571</td>
<td style="text-align: center;">-813.4576</td>
<td style="text-align: center;">-813.4576</td>
<td style="text-align: center;">-813.4571</td>
<td style="text-align: center;">-813.4571</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Over Dispersion</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.434067</td>
<td style="text-align: center;">0.4340993</td>
<td style="text-align: center;">0.4347778</td>
<td style="text-align: center;">0.4341682</td>
<td style="text-align: center;">0.4340679</td>
<td style="text-align: center;">0.4340165</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="final-conclusion" class="level1"><h1>Final Conclusion</h1>
<p>Now we can conclude the above findings using the tables provided, and it is clear that there is no strong change in expected frequencies, maximum Log Likelihood value or p-value if we use any one of the methods mentioned above. If time is crucial it is best to avoid BFGSR and SANN methods as they take considerable amount of time. I would recommend choose the analytical method from maxLik function based on your needs of output and research objective.</p>
<p><em>THANK YOU</em></p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">Â© 2023 Amalan CC BY-SA 4.0</span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block"><a href="https://github.com/marvinschmitt/quarto-website-template/">View source on GitHub</a></span></p>
</div>
  </div>
</footer>


</body></html>