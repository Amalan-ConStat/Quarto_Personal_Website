<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="M.Amalan">
<meta name="dcterms.date" content="2018-12-04">

<title>Benchmarking optimization functions in R â€“ Amalan Mahendran</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Amalan Mahendran</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../publication/index.html"> 
<span class="menu-text">Publication and Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/index.html"> 
<span class="menu-text">Blog Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tidytuesday/index.html"> 
<span class="menu-text">#TidyTuesday</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../interests/index.html"> 
<span class="menu-text">Interests</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-socials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Socials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-socials">    
        <li>
    <a class="dropdown-item" href="https://twitter.com/Amalan_Con_Stat"><i class="bi bi-hash" role="img">
</i> 
 <span class="dropdown-text">Twitter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bsky.app/profile/amalanconstat.bsky.social"><i class="bi bi-twitter" role="img">
</i> 
 <span class="dropdown-text">BlueSky</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/Amalan-ConStat"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/amalan-mahendran-72b86b37/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="dropdown-text">LinkedIn</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://scholar.google.com/citations?user=fj4E-GMAAAAJ&amp;hl=en"><i class="bi bi-google" role="img">
</i> 
 <span class="dropdown-text">Google Scholar</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.researchgate.net/profile/Amalan_Mahendran"><i class="bi bi-r-square-fill" role="img">
</i> 
 <span class="dropdown-text">Researchgate</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://amalan-constat.r-universe.dev/builds"><i class="bi bi-box-fill" role="img">
</i> 
 <span class="dropdown-text">R Universe</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="mailto:mail.amalan0595@gmail.com"><i class="bi bi-mailbox" role="img">
</i> 
 <span class="dropdown-text">Email Me</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Benchmarking optimization functions in R</h1>
  <div class="quarto-categories">
    <div class="quarto-category">bbmle</div>
    <div class="quarto-category">Beta-Binomial</div>
    <div class="quarto-category">fitODBOD</div>
    <div class="quarto-category">maxLik</div>
    <div class="quarto-category">mle</div>
    <div class="quarto-category">mle2</div>
    <div class="quarto-category">nlm</div>
    <div class="quarto-category">nlminb</div>
    <div class="quarto-category">optim</div>
    <div class="quarto-category">ucminf</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>M.Amalan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 4, 2018</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>NOTE : Below post is valid for Package version 1.4.0 and Before. </strong></p>
<section id="estimating-the-shape-parameters-by-maximizing-the-log-likelihood-value-of-beta-binomial-distribution." class="level1">
<h1>Estimating the shape parameters by Maximizing the Log Likelihood value of Beta-Binomial Distribution.</h1>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>When we need to estimate parameters from a discrete distribution or continuous distribution or a function we can use the below mentioned R functions. We will be using the technique of maximizing the Log Likelihood function or minimizing the Negative Log Likelihood function. Based on this technique we will compare these R functions because it might benefit people who are struggling which one to choose. We have 7 functions in total by my knowledge when I was writing this blog post.</p>
<p>Using the <a href="https://cran.r-project.org/package=fitODBOD">fitODBOD</a> package, I will use the Alcohol Consumption data to try and model it for the Beta-Binomial Distribution, which has two shape parameters to estimate. The process is that we find values for shape parameters a and b (or <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>) which will maximize the Log Likelihood function of Beta Binomial Distribution or in our case minimize the Negative Log Likelihood function of Beta Binomial Distribution.</p>
<p>Above mentioned Beta-Binomial distributionâ€™s Probability Mass Function(PMF) is denoted as</p>
<p><span class="math display">\[P_{BetaBin}(x)= {n \choose x} \frac{B(\alpha+x,n+\beta-x)}{B(\alpha,\beta)} \]</span></p>
<p>where <span class="math inline">\(n=0,1,2,...\)</span>, <span class="math inline">\(x=0,1,2,...,n\)</span> and <span class="math inline">\(\alpha,\beta &gt; 0\)</span>. Further <span class="math inline">\(x\)</span> is the Binomial Random variable, a,b(or <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) are shape parameters and <span class="math inline">\(n\)</span> is the binomial trial value. Also B(<span class="math inline">\(\alpha\)</span>,<span class="math inline">\(\beta\)</span>) is the Beta function. In this distribution we have to estimate the values for a and b.</p>
<p>Further, using the PMF we can construct the Likelihood function for <span class="math inline">\(\Omega_{BB}=(\alpha,\beta)^T\)</span> as given below:</p>
<p><span class="math display">\[L(\Omega_{BB}|x)=\prod_{i=1}^{N} \binom{n}{x_i} \frac{B(\alpha+x_i,n+\beta-x_i)}{B(\alpha,\beta)}\]</span></p>
<p>where N is the Number of observations. Then Negative Log Likelihood function is given as</p>
<p><span class="math display">\[l(\Omega_{BB}|x)=-\sum_{i=1}^{N} log\binom{n}{x_i} + \sum_{i=1}^{N} log(B(\alpha+x_i,n+\beta-x_i)) - Nlog(B(\alpha,\beta))\]</span></p>
<p>In the package fitODBOD we have the function EstMLEBetaBin which is constructed based on the above Negative Log Likelihood function, and we will use it.</p>
<p>We take Log to transform the Likelihood function values, which will simplify the computation process and save time. The optimization functions we need to compare will use specific mathematical methods to find the most appropriate shape parameter values.</p>
<p>The functions in question are</p>
<ol type="1">
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/optim">optim</a></li>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlm">nlm</a></li>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlminb">nlminb</a></li>
<li><a href="https://www.rdocumentation.org/packages/ucminf/versions/1.1-4/topics/ucminf">ucminf</a></li>
<li><a href="https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxLik">maxLik</a></li>
<li><a href="https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle">mle</a></li>
<li><a href="https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2">mle2</a></li>
</ol>
<p>Further, I will focus on the attributes of the above functions. Focusing from which package, Number of Inputs, Number of Outputs, Time to complete optimization and Analytical Methods used with the assistance in two tables. Alcohol Consumption data has two sets of frequency values but only values from week 1 will be used. Below is the the Alcohol Consumption data, where number of observations is 399 and the Binomial Random variable is a vector of values from zero to seven.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitODBOD)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Alcohol_data,<span class="st">"html"</span>,<span class="at">align=</span><span class="fu">c</span>(<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>),<span class="at">font_size =</span> <span class="dv">14</span>,<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>,<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">Days</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">week1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">week2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; color: red !important;">0</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">42</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">1</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">47</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">2</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">54</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">3</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">4</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">49</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">5</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">6</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">43</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">7</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">84</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="optim-function" class="level2">
<h2 class="anchored" data-anchor-id="optim-function">optim Function</h2>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#O">optim</a> is the first function in concern. <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/optim">Documentation</a> of the optim function is useful and it indicates that this function is only used on one input situations only. This means our EstMLEBetaBin function has to be modified. Reason for this is only the parameters that should be estimated need to be input values but our EstMLEBetaBin function has four parameters which are a,b,x(Binomial Random Variable) and freq(corresponding frequency values).</p>
<p>While using optim function first index refers to shape parameter a and second index refers to shape parameter b. Further, we have to input the observations or in our case the Binomial random variable values and their respective frequencies. I think it is inconvenient to modify the EstMLEBetaBin function, because if we want to estimate parameters for different data-sets it would become tedious. After modification we have a new function foroptim which can be used for demonstration and comparison.</p>
<p>Below is the code to estimation and going through the outputs. It should be noted that we have to provide initial parameter values as an input to the optim function, and it is best to provide values in the domain of shape parameter values which we want to estimate.</p>
<p>Here the shape parameters a and b are in the region of greater than zero but less than positive infinity (<span class="math inline">\(+\infty &gt;a,b&gt;0\)</span>). So for the initial parameters of a=0.1 and b=0.2 we are finding parameters which would minimize the Negative Log Likelihood function of Beta-Binomial distribution with the Alcohol Consumption data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new function to facilitate optim criteria</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only one input but has two elements</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>foroptim<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days, <span class="at">freq=</span>Alcohol_data<span class="sc">$</span>week1,<span class="at">a=</span>a[<span class="dv">1</span>],<span class="at">b=</span>a[<span class="dv">2</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default mathematical method</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>),<span class="at">fn=</span>foroptim)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining class of output</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(optim_answer)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#length of output</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(optim_answer)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="sc">$</span>par <span class="co"># estimated values for a, b</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="sc">$</span>value <span class="co"># minimized function value </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="sc">$</span>counts  <span class="co"># see the documentation to understand</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="sc">$</span>convergence <span class="co"># indicates successful completion</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>optim_answer<span class="sc">$</span>message <span class="co"># additional information</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter  values</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>           optim_answer<span class="sc">$</span>par[<span class="dv">1</span>],optim_answer<span class="sc">$</span>par[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So the foroptim function can be used as above and parameters are estimated for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (or a, b) for the Alcohol Consumption data week 1. Further we have scrutinized the function as below.</p>
<ul>
<li>package : stats</li>
<li>No of Inputs: 7</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list</li>
<li>No of outputs: 5</li>
<li>No of Analytical Methods : 6</li>
<li>Default Method : Nelder-Mead</li>
</ul>
</section>
<section id="nlm-function" class="level2">
<h2 class="anchored" data-anchor-id="nlm-function">nlm Function</h2>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#N">nlm</a> function is also similar to optim but only one analytical method will be used, which is a Newton-type Algorithm. Here also there needs to be changes made to our EstMLEBetaBin function as previously. After making those changes we have called the new Negative Log-likelihood function of Beta-Binomial distribution as fornlm. Then we can use the nlm function and estimate a and b for the initial shape parameter values of 0.1 and 0.2 respectively. <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlm">Documentation</a> of nlm function is very useful so that we can understand how it works.</p>
<p>Below is the code for using nlm function appropriately and fiddling with the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new function to facilitate nlm criteria</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fornlm<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days, <span class="at">freq=</span>Alcohol_data<span class="sc">$</span>week1,<span class="at">a=</span>a[<span class="dv">1</span>],a[<span class="dv">2</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#optimizing values for a,b using the only analytical method</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="ot">&lt;-</span><span class="fu">nlm</span>(<span class="at">f=</span>fornlm,<span class="at">p=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#obtaining class of output</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(nlm_answer)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#length of output</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(nlm_answer)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="sc">$</span>estimate <span class="co"># estimated values for a, b</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="sc">$</span>minimum <span class="co"># minimized function value </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="sc">$</span>gradient  <span class="co"># gradient at the estimated minimum of given funciton</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="sc">$</span>code <span class="co"># indicates successful completion</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>nlm_answer<span class="sc">$</span>iterations <span class="co"># number of iterations performed</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter  values</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>           nlm_answer<span class="sc">$</span>estimate[<span class="dv">1</span>],nlm_answer<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly for the fornlm function we have estimated values for a and b which would fit the Alcohol consumption data of week 1. Below is a point form summary of nlm function.</p>
<ul>
<li>package : stats</li>
<li>No of Inputs: 12</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list</li>
<li>No of outputs: 5</li>
<li>No of Analytical Methods : 1</li>
<li>Default Method : Newton-type Algorithm</li>
</ul>
</section>
<section id="nlminb-function" class="level2">
<h2 class="anchored" data-anchor-id="nlminb-function">nlminb Function</h2>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#N">nlminb</a> is also similar and requires the EstMLEBetaBin function to be restructured as similar to previous situations. After this task we now have a function called fornlminb. nlminb function is based on analytical method of unconstrained and box-constrained optimization using PORT routines.</p>
<p>After choosing initial parameter values for a and b, which are respectively 0.1 and 0.2 the estimation was done following the process below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new function to facilitate nlminb criteria</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fornlminb<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days, <span class="at">freq=</span>Alcohol_data<span class="sc">$</span>week1,<span class="at">a=</span>a[<span class="dv">1</span>],a[<span class="dv">2</span>])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default analytical method</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="ot">&lt;-</span><span class="fu">nlminb</span>(<span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>), <span class="at">objective=</span>fornlminb)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining class of output</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(nlminb_answer)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># length of output</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(nlminb_answer)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>par <span class="co"># estimated values for a, b</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>objective <span class="co"># minimized function value </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>evaluations  <span class="co"># see the documentation to understand</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>convergence <span class="co"># indicates successful completion</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>message <span class="co"># additional information</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>nlminb_answer<span class="sc">$</span>iterations <span class="co"># number of iterations performed</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>           nlminb_answer<span class="sc">$</span>par[<span class="dv">1</span>],nlminb_answer<span class="sc">$</span>par[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlminb">Documentation</a> includes the information related to the function therefore referring it will be useful. After estimating values for a and b using nlminb function these were noticed regarding the function in concern</p>
<ul>
<li>package : stats</li>
<li>No of Inputs: 8</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list</li>
<li>No of outputs: 6</li>
<li>No of Analytical Methods : 1</li>
<li>Default Method : Unconstrained and box-constrained optimization using PORT routines</li>
</ul>
</section>
<section id="ucminf-function" class="level2">
<h2 class="anchored" data-anchor-id="ucminf-function">ucminf Function</h2>
<p>Package <a href="https://cran.r-project.org/package=ucminf">ucminf</a> produces the ucminf function, as previously mentioned functions here also we have to change the EstMLEBetaBin function. After making the changes we will be using the forucminf function to the estimation process of shape parameters a and b.</p>
<p>When initial parameter values are set to a=0.1 and b=0.2 we will obtain results from ucminf function, which will minimize the Negative Log-likelihood value of Beta-Binomial distribution. Below is the code for estimation and using the results to understand the function ucminf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ucminf)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new function to facilitate ucminf criteria</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>forucminf<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days,<span class="at">freq =</span> Alcohol_data<span class="sc">$</span>week1,<span class="at">a=</span>a[<span class="dv">1</span>],a[<span class="dv">2</span>])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default analytical method</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="ot">&lt;-</span><span class="fu">ucminf</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>),<span class="at">fn=</span>forucminf)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#obtaining class</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ucminf_answer)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># length of output</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ucminf_answer)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>par <span class="co"># estimated values for a, b</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>value <span class="co"># minimized function value </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>invhessian.lt  <span class="co"># see the documentation understand</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>convergence <span class="co"># indicates successful completion</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>message <span class="co"># additional information</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>ucminf_answer<span class="sc">$</span>info</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>           ucminf_answer<span class="sc">$</span>par[<span class="dv">1</span>],ucminf_answer<span class="sc">$</span>par[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the help of R <a href="https://www.rdocumentation.org/packages/ucminf/versions/1.1-4/topics/ucminf">Documentation</a> the estimation was done for shape parameter values a and b using the ucminf function. Below is the initial understanding of the ucminf function</p>
<ul>
<li>package : ucminf</li>
<li>No of Inputs: 5</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list</li>
<li>No of outputs: 6</li>
<li>No of Analytical Methods : 1</li>
<li>Default Method : Quasi-Newton Algorithm type with BFGS updating</li>
</ul>
</section>
<section id="maxlik-function" class="level2">
<h2 class="anchored" data-anchor-id="maxlik-function">maxLik Function</h2>
<p>maxLik function is from the <a href="https://cran.r-project.org/package=maxLik">maxLik</a> package, which only maximizes the Log Likelihood function. Therefore we have to restructure EstMLEBetaBin as previously mentioned, but as an addition a negative sign is added for the output. This new function will be called as formaxLik.</p>
<p>For the initial parameter values where a=0.1 and b=0.2 the maxLik function will be used and results will be evaluated as below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maxLik)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new function to facilitate maxLik criteria</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>formaxLik<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days,<span class="at">freq =</span> Alcohol_data<span class="sc">$</span>week1,<span class="at">a=</span>a[<span class="dv">1</span>],a[<span class="dv">2</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default analytical method</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="ot">&lt;-</span><span class="fu">maxLik</span>(<span class="at">logLik =</span>formaxLik, <span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining class of output</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(maxLik_answer)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># length of output</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(maxLik_answer)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>estimate <span class="co"># estimated values for a, b</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>maximum <span class="co"># minimized function value </span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>iterations  <span class="co"># no of iterations to succeed</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>gradient <span class="co"># last gradient value which was calculated</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>message <span class="co"># additional information</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>hessian <span class="co"># hessian matrix</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>code <span class="co"># indicates successful completion</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>fixed <span class="co"># logical vector indicating which parameters are constants</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>type <span class="co"># type of maximization</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>last.step <span class="co"># list describing the last unsuccessful step</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>maxLik_answer<span class="sc">$</span>control <span class="co"># see the documentation understand</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>           maxLik_answer<span class="sc">$</span>estimate[<span class="dv">1</span>],maxLik_answer<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the <a href="https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxLik">Documentation</a> of maxLik and the <a href="https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxNR">Documentation</a> of maxNR function the above analysis was done for the maxLik function. According to the above code, below are the findings from the maxLik function in point form</p>
<ul>
<li>package : maxLik</li>
<li>No of Inputs: 6</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list or class of maxim or class of maxLik</li>
<li>No of outputs: 11</li>
<li>No of Analytical Methods : 7</li>
<li>Default Method : Automatically chosen</li>
</ul>
</section>
<section id="mle-function" class="level2">
<h2 class="anchored" data-anchor-id="mle-function">mle Function</h2>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats4/html/00Index.html">stats4</a> package is installed so that mle function can be operated for the purpose of estimating a and b parameters. Here also as previously we need to make some changes as below and create a new Negative Log Likelihood function called formle.</p>
<p>For the initial parameter values of a=0.1 and b=0.2 the Negative Log Likelihood value of Beta-Binomial distribution has been minimized using mle function. Below is the code for estimation and investigation from the outputs of mle after estimation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new function to facilitate mle criteria</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>formle<span class="ot">&lt;-</span><span class="cf">function</span>(a,b)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">EstMLEBetaBin</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days,<span class="at">freq =</span> Alcohol_data<span class="sc">$</span>week1,a,b)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default analytical method</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="ot">&lt;-</span><span class="fu">mle</span>(<span class="at">minuslogl=</span>formle,<span class="at">start =</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.1</span>,<span class="at">b=</span><span class="fl">0.2</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining class</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mle_answer)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># length of output</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mle_answer)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>call <span class="co"># inputs i have used </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>coef <span class="co"># estimated values for a,b</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>fullcoef <span class="co"># all values, even the fixed values we did not want to estimate</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>vcov <span class="co"># variance covariance matrix for a,b</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>min <span class="co"># minimized function value</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>details <span class="co"># details after estimation process</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>nobs <span class="co"># number of observations to be used for computing only if given </span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>mle_answer<span class="sc">@</span>method <span class="co"># optimization methods used</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Methods used</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mle_answer) <span class="co"># confidence intervals for estimated values</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mle_answer) <span class="co"># Negative loglikelihood value for estimated values </span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(mle_answer) <span class="co"># Likelihood profile generation.</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(mle_answer) <span class="co"># number of observations to be used for computing only if given</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(mle_answer) <span class="co"># display object briefly</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle_answer) <span class="co"># generate a summary</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#update()   # updating if we have new data and need to estimate new values</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(mle_answer) <span class="co"># variance covariance matrix</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>           mle_answer<span class="sc">@</span>coef[<span class="dv">1</span>],mle_answer<span class="sc">@</span>coef[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It should be noted that in all 5 previous functions we had only outputs in the form of lists, but through mle we are seeing a class of mle output.The <a href="https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle">Documention</a> explains the inputs and outputs of mle. <a href="https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle-class">Documentation</a> for mle-class explains further about the methods that can be used. Below is a list of findings based on the outputs of the mle function.</p>
<ul>
<li>package : stats4</li>
<li>No of Inputs: 5</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : class of mle</li>
<li>No of outputs: 9</li>
<li>Methods for output: 8</li>
<li>No of Analytical Methods :6</li>
<li>Default Method : Nelder and Mead</li>
</ul>
</section>
<section id="mle2-function" class="level2">
<h2 class="anchored" data-anchor-id="mle2-function">mle2 Function</h2>
<p>mle2 function is advanced than mle function and it is from the package <a href="https://cran.r-project.org/package=bbmle">bbmle</a>. Here, there is no need to modify the EstMLEBetabin function from the fitODBOD package to estimation as all previous situations .</p>
<p>For the initial parameter values of a=0.1 and b=0.2 Negative Log Likelihood function of Beta-Binomial distribution will be minimized where outputs will be investigated and methods related to output of class mle2 will be used.</p>
<p>Below is the code for using mle2 function and scrutinizing the output and methods related to it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing values for a,b using default analytical method</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="ot">&lt;-</span><span class="fu">mle2</span>(<span class="at">minuslogl=</span> EstMLEBetaBin,<span class="at">start =</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.1</span>,<span class="at">b=</span><span class="fl">0.2</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> <span class="fu">list</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days,<span class="at">freq=</span>Alcohol_data<span class="sc">$</span>week1))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining class</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mle2_answer)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># length of output</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mle2_answer)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the outputs</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>call <span class="co"># inputs generally considered </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>call.orig <span class="co"># inputs i have given</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>coef <span class="co"># estimated values for a,b</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>fullcoef <span class="co"># all values, even the fixed values we did not want to estimate</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>vcov <span class="co"># variance covariance matrix for a,b</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>min <span class="co"># minimized function value</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>details <span class="co"># details after estimation process</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>method <span class="co"># optimization methods used</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>data <span class="co"># data used for estimation </span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>formula <span class="co"># if a formula was specified in the input </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>mle2_answer<span class="sc">@</span>optimizer <span class="co"># function used for optimizing</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Methods used</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mle2_answer) <span class="co"># extrat the estimated values</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mle2_answer) <span class="co"># confidence intervals for estimated values</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(mle2_answer) <span class="co"># display object briefly</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle2_answer) <span class="co"># generate a summary</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#update()   #updating if we have new data and need to estimate new values</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(mle2_answer) <span class="co"># variance covariance matrix</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#formula(mle2_answer) # if a formula was specified in the input </span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(mle2_answer) # plot the profile</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mle2_answer) <span class="co"># Negative loglikelihood value for estimated values </span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(mle2_answer) <span class="co"># profile of estimated values</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting the Beta-Binomial distribution with estimated shape parameter values</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="fu">fitBetaBin</span>(Alcohol_data<span class="sc">$</span>Days,Alcohol_data<span class="sc">$</span>week1,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>           mle2_answer<span class="sc">@</span>coef[<span class="dv">1</span>],mle2_answer<span class="sc">@</span>coef[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2">Documention</a> of mle2 function and <a href="https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2-class">Documentation</a> of mle2-class<br>
provide a few findings as mentioned below in point form.</p>
<ul>
<li>package : bbmle</li>
<li>No of Inputs: 22</li>
<li>Minimum required Inputs : 3</li>
<li>Class of output : class of mle2</li>
<li>No of outputs: 12</li>
<li>Methods for output: 9</li>
<li>No of Analytical Methods : 6</li>
<li>Default Method : Nelder and Mead</li>
</ul>
</section>
</section>
<section id="summary-of-the-seven-optimization-functions-in-r" class="level1">
<h1>Summary of the seven optimization functions in R</h1>
<p>After completing a brief fact finding of the R functions optim, nlm, nlminb, ucminf, maxLik, mle and mle2. We can record the facts and results in two tables. Using them we can choose the best suitable function for our needs of estimation from optimization.</p>
<p>Mostly I prefer mle2 function than others because it provides special methods to handle the mle2 outputs, and the output themselves are very thorough than other R function outputs.</p>
<p>It can be seen that estimated a and b shape parameter values are different only from the third decimal point in all outputs. But this does not effect the minimized Negative Log Likelihood value of Beta-Binomial distribution for our Alcohol Consumption data, which is same for all outputs.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">Function</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">optim</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">nlm</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">nlminb</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">ucminf</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">maxLik</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">mle</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">mle2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; color: red !important;">Package</td>
<td style="text-align: center;">stats</td>
<td style="text-align: center;">stats</td>
<td style="text-align: center;">stats</td>
<td style="text-align: center;">ucminf</td>
<td style="text-align: center;">maxLik</td>
<td style="text-align: center;">stats4</td>
<td style="text-align: center;">bbmle</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">No of Inputs</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Minimum No of Inputs</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">Analytical Methods</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Output Type</td>
<td style="text-align: center;">List</td>
<td style="text-align: center;">List</td>
<td style="text-align: center;">List</td>
<td style="text-align: center;">List</td>
<td style="text-align: center;">List class maxLik class maxim</td>
<td style="text-align: center;">class mle</td>
<td style="text-align: center;">class mle2</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">No of Outputs</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">No of Methods</td>
<td style="text-align: center;">None</td>
<td style="text-align: center;">None</td>
<td style="text-align: center;">None</td>
<td style="text-align: center;">None</td>
<td style="text-align: center;">None</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">Initial value(a,b)</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
<td style="text-align: center;">a=0.1 b=0.2</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Estimated value(a,b)</td>
<td style="text-align: center;">a=0.7230707 b=0.5809894</td>
<td style="text-align: center;">a=0.7229384 b=0.5808448</td>
<td style="text-align: center;">a=0.7229404 b=0.5808469</td>
<td style="text-align: center;">a=0.7229390 b=0.5808458</td>
<td style="text-align: center;">a=0.7229428 b=0.5808488</td>
<td style="text-align: center;">a=0.7228930 b=0.5807279</td>
<td style="text-align: center;">a=0.7228930 b=0.5807279</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">Negative Log Likelihood value</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
<td style="text-align: center;">813.4571</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="summary-of-time-evaluation-for-the-seven-optimization-r-functions" class="level1">
<h1>Summary of Time evaluation for the seven optimization R functions</h1>
<p>Further at the beginning I have mentioned to evaluate the system process time for the seven functions. In order to do this time comparison it is possible to use the <a href="https://www.rdocumentation.org/packages/rbenchmark/versions/1.0.0/topics/benchmark">benchmark</a> function of <a href="https://cran.r-project.org/package=rbenchmark">rbenchmark</a> package, and below mentioned code chunk provides the output in a table form. It includes the functions and their respective time values. The estimation process of the parameters where each function has been replicated 1000 times to receive a more accurate table of time values.</p>
<p>The table is in ascending order according to the elapsed time values column. According to this we can see that least time takes to the nlminb function and most time is taken to the mle2 function. These times completely depends on the Negative Log Likelihood function you need to minimize, the data you provided, the number of estimators that needs to be estimated, the complexity of the function and finally your computerâ€™s processing power.</p>
<p>Therefore based on the needs of your output and the function which needs estimation choose the best function out of the above seven. Because as I said related to the earlier table the estimated values are slightly different but does not make any strong influence on the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rbenchmark)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Results2<span class="ot">&lt;-</span><span class="fu">benchmark</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">"optim"</span><span class="ot">=</span>{<span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>), <span class="at">fn =</span> foroptim)},</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"nlm"</span><span class="ot">=</span>{<span class="fu">nlm</span>(<span class="at">f =</span> fornlm, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))},</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"nlminb"</span><span class="ot">=</span>{<span class="fu">nlminb</span>(<span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>), <span class="at">objective =</span> fornlminb)},</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ucminf"</span><span class="ot">=</span>{<span class="fu">ucminf</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>), <span class="at">fn =</span> forucminf)},</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"maxLik"</span><span class="ot">=</span>{<span class="fu">maxLik</span>(<span class="at">logLik =</span> formaxLik, <span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))},</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"mle"</span><span class="ot">=</span>{<span class="fu">mle</span>(<span class="at">minuslogl =</span> formle, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.1</span>,<span class="at">b=</span><span class="fl">0.2</span>))},</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"mle2"</span><span class="ot">=</span>{<span class="fu">mle2</span>(<span class="at">minuslogl =</span> EstMLEBetaBin, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.1</span>, <span class="at">b=</span><span class="fl">0.2</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> <span class="fu">list</span>(<span class="at">x=</span>Alcohol_data<span class="sc">$</span>Days, <span class="at">freq=</span>Alcohol_data<span class="sc">$</span>week1))},</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">replications =</span> <span class="dv">1000</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"test"</span>,<span class="st">"replications"</span>,<span class="st">"elapsed"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"relative"</span>,<span class="st">"user.self"</span>,<span class="st">"sys.self"</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">order =</span> <span class="st">'elapsed'</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Results2,<span class="st">"html"</span>,<span class="at">align =</span> <span class="fu">c</span>(<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F,<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>),<span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>,<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; color: blue !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">test</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">replications</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">elapsed</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">relative</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">user.self</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">sys.self</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; color: red !important;">3</td>
<td style="text-align: center;">nlminb</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">6.11</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">6.01</td>
<td style="text-align: center;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">4</td>
<td style="text-align: center;">ucminf</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">7.19</td>
<td style="text-align: center;">1.177</td>
<td style="text-align: center;">7.14</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important;">2</td>
<td style="text-align: center;">nlm</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">8.00</td>
<td style="text-align: center;">1.309</td>
<td style="text-align: center;">8.00</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">1</td>
<td style="text-align: center;">optim</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">9.80</td>
<td style="text-align: center;">1.604</td>
<td style="text-align: center;">9.77</td>
<td style="text-align: center;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important;">6</td>
<td style="text-align: center;">mle</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">21.25</td>
<td style="text-align: center;">3.478</td>
<td style="text-align: center;">21.03</td>
<td style="text-align: center;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important;">5</td>
<td style="text-align: center;">maxLik</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">33.68</td>
<td style="text-align: center;">5.512</td>
<td style="text-align: center;">33.25</td>
<td style="text-align: center;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important;">7</td>
<td style="text-align: center;">mle2</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">34.88</td>
<td style="text-align: center;">5.709</td>
<td style="text-align: center;">34.22</td>
<td style="text-align: center;">0.48</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="summary-of-results-after-estimating-parameters-using-the-optimization-r-functions" class="level1">
<h1>Summary of Results after estimating parameters using the optimization R functions</h1>
<p>After using the functions optim, nlm, nlminb, ucminf, maxLik, mle and mle2 to estimate the shape parameters a, b we can use the estimated parameters in the function fitBetaBin. Using this function we can find expected frequencies for each of the estimated parameters a,b and compare p-values and over-dispersion and understand if using different optimization functions had any effect on them.</p>
<p>According to the below table there is no significant changes between the expected frequencies, p-values or the over dispersion values. This is a clear indication that it does not matter what function we use for the optimization. Because the process will occur effectively only efficiency(time) will be affected.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">BinomialRandomVariable</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">Frequency</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">optim</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">nlm</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">nlminb</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">ucminf</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">maxLik</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">mle</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: blue !important;">mle2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; color: red !important;">0</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">54.61</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
<td style="text-align: center;">54.62</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">1</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">42</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">2</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">38.91</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">38.9</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">3</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
<td style="text-align: center;">38.54</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">4</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
<td style="text-align: center;">40.07</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">5</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">43.99</td>
<td style="text-align: center;">43.99</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">6</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
<td style="text-align: center;">53.09</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">7</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">87.77</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.78</td>
<td style="text-align: center;">87.8</td>
<td style="text-align: center;">87.8</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Total No of Observations</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">398.99</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">399.01</td>
<td style="text-align: center;">399</td>
<td style="text-align: center;">399.01</td>
<td style="text-align: center;">399.01</td>
</tr>
<tr class="even">
<td style="text-align: center; color: red !important;">p-value</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.0902</td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0901</td>
<td style="text-align: center;">0.0903</td>
<td style="text-align: center;">0.0903</td>
</tr>
<tr class="odd">
<td style="text-align: center; color: red !important;">Over Dispersion</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.4340165</td>
<td style="text-align: center;">0.4340686</td>
<td style="text-align: center;">0.4340679</td>
<td style="text-align: center;">0.4340683</td>
<td style="text-align: center;">0.434067</td>
<td style="text-align: center;">0.4340992</td>
<td style="text-align: center;">0.4340992</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="final-conclusion" class="level1">
<h1>Final Conclusion</h1>
<p>We had 7 functions to compare but choosing one over the other is completely harmless to the final result of estimation as seen by our tables. The only issue is time, therefore I would recommend choose the best function based on your needs of output and research objective.</p>
<p><em>THANK YOU</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">Â© 2023 Amalan CC BY-SA 4.0</span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block"><a href="https://github.com/marvinschmitt/quarto-website-template/">View source on GitHub</a></span></p>
</div>
  </div>
</footer>




</body></html>