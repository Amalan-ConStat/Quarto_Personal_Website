{
  "hash": "dd8ce8a1b5b20b3c2d942ed6e392d7f2",
  "result": {
    "markdown": "---\ntitle: 'Week 28: FIFA Womens World Cup'\ndate: '2019-07-10'\ncategories:\n  - TidyTuesday\n  - 2019\nimage: featured.png\ndraft: false\nnumber-sections: false\nformat:\n  html:\n    fig-cap-location: bottom\nresources: \n  - \"featured.png\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/wwc_outcomes.csv\")\nsquads <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/squads.csv\")\ncodes <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/codes.csv\")\n\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(dplyr)\nlibrary(tvthemes)\n```\n:::\n\n\n[GitHub Code](https://github.com/Amalan-ConStat/TidyTuesday/tree/master/2019/Week28)\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n{{% tweet \"1148866198370750464\" %}}\n```\n:::\n:::\n\n\n# Squads\n\n## Captain-ship vs Goals\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-ggplot(squads,aes(caps,goals,color=pos,label1=player,label2=country,group=1))+geom_point()+\n    ylab(\"No of Goals Scored\")+xlab(\"No of Matches as Captains\")+\n    ggtitle(\"Relationship Between Goals Scoring and Captain-ship\",\n            subtitle = \"This is plotly so click on the points on legend\")+\n    theme_parksAndRec()+labs(color=\"Position\")\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Captiainship vs Goals-1.png){width=1152}\n:::\n\n```{.r .cell-code}\n#plotly::plotly_build(p1)\n```\n:::\n\n\n## Age vs Goals\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-ggplot(squads,aes(age,goals,color=pos,label1=player,label2=country,group=1))+geom_point()+\n    xlab(\"Age of the Player\")+ylab(\"No of Goals Scored\")+\n    ggtitle(\"Relationship Between Goals Scoring and Age\",\n            subtitle = \"This is plotly so click on the points on legend\")+\n    theme_parksAndRec()+labs(color=\"Position\")\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Age vs Goals-1.png){width=1152}\n:::\n\n```{.r .cell-code}\n#plotly::plotly_build(p1)\n```\n:::\n\n\n## Country and Positions \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsquads %>%\n  group_by(country,pos) %>%\n  count() %>%\n  ggplot(.,aes(country,n,fill=pos,label=n))+geom_col()+\n         theme_parksAndRec()+labs(fill=\"Position\")+\n         xlab(\"Country\")+ylab(\"Count of Players\")+geom_text(position = \"stack\",vjust=1)+\n         ggtitle(\"Positions and their counts according to Country\")+\n         theme(axis.text.x = element_text(angle = 90,vjust=0))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/country and positions-1.png){width=1152}\n:::\n:::\n\n\n## Age and Positions \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsquads %>%\n  group_by(age,pos) %>%\n  count() %>%\n  ggplot(.,aes(factor(age),n,fill=pos,label=n))+geom_col()+\n         xlab(\"Age\")+ylab(\"Count of Players\")+geom_text(position = \"stack\",vjust=1,size=3.5)+\n         ggtitle(\"Positions and their counts according to Age\")+\n         theme_parksAndRec()+labs(fill=\"Position\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/age and positions-1.png){width=1152}\n:::\n:::\n\n\n## Country and Age Distributions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(squads,aes(age,country))+\n       ggridges::geom_density_ridges(scale=1.45,jittered_points=TRUE,fill=\"green\",alpha=0.8)+\n       theme_parksAndRec()+\n       scale_x_continuous(breaks=seq(10,45,5),labels=seq(10,45,5))+\n       scale_y_discrete(expand = c(0, 1))+\n       xlab(\"Age\")+ylab(\"Country\")+\n       ggtitle(\"Country vs Age Distribution\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Country and age-1.png){width=864}\n:::\n:::\n\n\n## Country and Goal Experience\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsquads %>%\n  group_by(country=factor(country)) %>%\n  na.omit() %>%\n  summarise(goal_count=sum(goals)) %>%\nggplot(.,aes(x=country,y=goal_count,label=goal_count))+geom_col(fill=\"lightgreen\")+\n       theme_parksAndRec_light()+geom_text(vjust=-0.5,color=blues9[9],size=5)+\n       xlab(\"Country\")+ylab(\"No of Goals Scored by All Players\")+\n       ggtitle(\"No of Goals Scored with Country as in Experience\")+\n       theme(axis.text.x = element_text(angle = 90,vjust=0))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Country and Goal Experience-1.png){width=1152}\n:::\n:::\n\n\n## Top 15 Highest Goal Scorers participated in the FIFA World Cup \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsquads %>%\n  top_n(15,goals) %>%\n  select(country,player,goals) %>% \nggplot(.,aes(stringr::str_wrap(player,10),goals,fill=country,label=goals))+geom_col()+\n       xlab(\"Player\")+ylab(\"No of Goals\")+theme_parksAndRec_light()+\n       labs(fill=\"Country\")+geom_text(vjust=-0.5,size=7,color=\"green\")+\n       theme(axis.text.x = element_text(angle = 90,vjust=0))+\n       ggtitle(\"Top 15 Players who have played most number of Goals So Far\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 15 Highest Goal scorers-1.png){width=1152}\n:::\n:::\n\n\n# WWC Outcomes\n\n## Year vs Countries of participation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes %>%\n  group_by(year,team) %>%\n  count(team) %>%\n  select(year,team) %>%\n  ungroup() %>%\n  count(year) %>%\nggplot(.,aes(factor(year),n,label=n))+geom_col(fill=blues9[5])+\n      geom_text(vjust=1,size=9,color=blues9[3])+theme_brooklyn99()+\n      xlab(\"Year\")+ylab(\"No of Countries Participated\")+\n      ggtitle(\"No of Countries participated by Year\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Year vs country-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes %>%\n  group_by(year,team) %>%\n  count(team) %>% \nggplot(.,aes(stringr::str_wrap(team,12),n,label=n))+\n      geom_col(fill=blues9[5])+\n      geom_text(vjust=1,size=6,color=blues9[3])+theme_brooklyn99()+\n      xlab(\"Country\")+ylab(\"No of Matches\")+\n      transition_states(year)+ease_aes(\"linear\")+\n      theme(axis.text.x = element_text(angle = 90,vjust=0))+\n      ggtitle(\"No of Matches played by a country changing over the Tournament\",\n              subtitle = \"Year:{closest_state}\")      \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Years vs Country gif-1.gif)\n:::\n:::\n\n\n## Year vs Rounds of Matches\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes %>%\n  group_by(year,round) %>%\n  count(round) %>%\n  select(year,round) %>%\n  ungroup() %>%\n  count(year) %>%\nggplot(.,aes(factor(year),n,label=n))+geom_col(fill=blues9[5])+\n      geom_text(vjust=1,size=9,color=blues9[3])+theme_brooklyn99()+\n      xlab(\"Year\")+ylab(\"No of Rounds in the Tournament\")+\n      ggtitle(\"No of Rounds by Year\")  \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Year vs Round-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes %>%\n  group_by(year,round) %>%\n  count(round) %>%\n  mutate(matches=n/2) %>%\nggplot(.,aes(stringr::str_wrap(round,12),matches,label=matches))+\n      geom_col(fill=blues9[5])+\n      geom_text(vjust=1,size=6,color=blues9[3])+theme_brooklyn99()+\n      xlab(\"Rounds of the Tournament\")+ylab(\"No of Matches\")+\n      transition_states(year)+ease_aes(\"linear\")+\n      ggtitle(\"No of Matches changing over the Tournament\",\n              subtitle = \"Year:{closest_state}\")    \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Year vs Round gif-1.gif)\n:::\n:::\n\n\n## Years vs Goals \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwwc_outcomes %>%\n  group_by(year) %>%\n  count(score) %>%\nggplot(.,aes(factor(score),n,label=n))+geom_col(fill=blues9[5])+\n      geom_text(vjust=1,size=6,color=blues9[3])+theme_brooklyn99()+\n      transition_states(year)+ease_aes(\"linear\")+\n      xlab(\"Goals Scored\")+ylab(\"No of Situations\")+\n      ggtitle(\"No of Goals Scored by Year with Situations\",\n              subtitle = \"Year :{closest_state}\")  \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Years vs Goals gif-1.gif)\n:::\n:::\n\n\n**THANK YOU**\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}