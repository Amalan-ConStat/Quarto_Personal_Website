{
  "hash": "f1f081cd3d84803f5ececd992b410423",
  "result": {
    "markdown": "---\ntitle: 'Week 27: Media Franchise Powerhouses'\ndate: '2019-07-02'\ncategories:\n  - TidyTuesday\n  - 2019\nimage: featured.png\ndraft: false\nnumber-sections: false\nformat:\n  html:\n    fig-cap-location: bottom\nresources: \n  - \"featured.png\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_franchises <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-02/media_franchises.csv\")\n\nlibrary(tidyverse)\nlibrary(cowplot)\nlibrary(rayshader)\nlibrary(ggmosaic)\nlibrary(gganimate)\nlibrary(viridis)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n{{% tweet \"1145985415326945280\" %}}\n```\n:::\n:::\n\n\n[GitHub Code](https://github.com/Amalan-ConStat/TidyTuesday/tree/master/2019/Week27)\n\n# Revenue Category and Original Media by Cow Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-media_franchises %>%\n    group_by(revenue_category) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%\nggplot(.,aes(x=str_wrap(revenue_category,15),y=revenue_total,fill=revenue_avg))+geom_col()+\n       xlab(\"Revenue Category\")+ylab(\"Revenue Total by $\")+\n       ggtitle(\"Revenue Category vs Revenue Total\",\n               subtitle = \"By Billions of Dollars\")+\n       theme(axis.text.x = element_text(size=10.5,angle = 90))+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")+\n       scale_y_continuous(expand = c(0,150))+\n       geom_text(aes(label=revenue_total),vjust=-0.5)\n  \np2<-media_franchises %>%\n    group_by(original_media) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%\nggplot(.,aes(x=str_wrap(original_media,15),y=revenue_total,fill=revenue_avg))+geom_col()+\n       xlab(\"Original Media\")+\n       ylab(\"Original media by $\")+\n       ggtitle(\"Original Media vs Revenue Total\",\n               subtitle = \"By Billions of Dollars\")+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")+\n       scale_y_continuous(expand = c(0,50))+\n       geom_text(aes(label=revenue_total),hjust=-0.15)+coord_flip()\n\nggdraw()+\n    draw_plot(p2+theme(legend.justification = \"top\"),0,0,1,1)+\n    draw_plot(p1+scale_color_viridis_d()+theme(legend.justification = \"bottom\"), 0.45, 0.08, 0.55, 0.55)+\n    draw_plot_label(c(\"A\", \"B\"), c(0, 0.55), c(1, 0.45), size = 5.5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/revenue category and original media-1.png){width=1152}\n:::\n:::\n\n\n# Revenue Category and Original Media by Animations\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-media_franchises %>%\n    group_by(year_created,revenue_category) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>% \nggplot(.,aes(x=str_wrap(revenue_category,15),y=revenue_total,\n             fill=revenue_avg))+ geom_col()+\n       xlab(\"Revenue Category\")+ ylab(\"Revenue Total by $\")+\n       transition_time(year_created)+ease_aes(\"linear\")+\n       ggtitle(\"Revenue Category vs Revenue Total\",\n               subtitle = \"By Billions of Dollars of Year : {round(frame_time)}\")+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")+\n       geom_text(aes(label=revenue_total),vjust=-0.5)\n\nanimate(p1,nframes=52,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Revenue Category Yearly change for revenue total-1.gif)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-media_franchises %>%\n    group_by(year_created,original_media) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>% \nggplot(.,aes(x=str_wrap(original_media,15),y=revenue_total,\n             fill=revenue_avg))+ geom_col()+coord_flip()+\n       xlab(\"Original Media\")+ ylab(\"Revenue Total by $\")+\n       transition_time(year_created)+ease_aes(\"linear\")+\n       ggtitle(\"Original Media vs Revenue Total\",\n               subtitle = \"By Billions of Dollars of Year : {round(frame_time)}\")+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")+\n       geom_text(aes(label=revenue_total),hjust=-0.05)\n\nanimate(p1,nframes=52,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Original Media Yearly change for revenue total-1.gif)\n:::\n:::\n\n\n# Revenue Category and Original Media by rayshader\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-media_franchises %>%\n    group_by(revenue_category) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%\n    ggplot(.,aes(x=str_wrap(revenue_category,10),y=revenue_total,fill=revenue_avg))+geom_col()+\n       xlab(\"Revenue Category\")+ylab(\"Revenue Total by $\")+\n       ggtitle(\"Revenue Category vs Revenue Total\",\n               subtitle = \"By Billions of Dollars\")+theme_minimal()+\n       theme(axis.text = element_text(size=7,angle = 90),\n             title = element_text(size=10))+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")+\n       scale_y_continuous(expand = c(0,150))\n\nplot_gg(p1,width=3.5,multicore = TRUE, windowsize = c(1000, 1000), \n        zoom = 0.85, phi = 60, theta = 30, sunangle = 270, soliddepth = -60)\nrender_snapshot(clear=TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/revenue category by rayshader-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1<-media_franchises %>%\n    group_by(original_media) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%\n    ggplot(.,aes(x=original_media,y=revenue_total,fill=revenue_avg))+geom_col()+\n       xlab(\"Original Media\")+ylab(\"Revenue Total by $\")+\n       ggtitle(\"Original Media vs Revenue Total\",\n               subtitle = \"By Billions of Dollars\")+theme_minimal()+\n       theme(axis.text = element_text(size=7,angle = 90))+\n       labs(fill=\"Revenue\\nAverage\\nIn Billions\")\n\nplot_gg(p1,width=3.5,multicore = TRUE, windowsize = c(1000, 800), \n        zoom = 0.85, phi = 40, theta = 50, sunangle = 270, soliddepth = -30)\nrender_snapshot(clear=TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/original media by rayshader-1.png){width=1152}\n:::\n:::\n\n\n# Revenue Category In Decades \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_franchises %>%\n    mutate(years=cut(year_created,\n                     breaks=c(1920,1929,1939,1949,\n                              1959,1969,1979,1989,\n                              1999,2009,2017),\n                     labels=c(\"1920s\",\"1930s\",\"1940s\",\"1950s\",\n                              \"1960s\",\"1970s\",\"1980s\",\"1990s\",\n                              \"2000s\",\"2010s\"))) %>%\n    group_by(years,revenue_category) %>%\nggplot(.) + \n    geom_mosaic(aes(x=product(years),fill=revenue_category))+\n    xlab(\"Years by Decade\")+ylab(\"Revenue Category\")+\n    theme(axis.text.x = element_text(angle=90))+\n    labs(fill=\"Revenue\\nCategory\")+\n    ggtitle(\"Mosaic Graph for Decades of Year vs Revenue of Category \")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Revenue Cateogry In Decades Mosiac plot-1.png){width=1152}\n:::\n:::\n\n\n# Revenue Category In Decades but with Total Revenue \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_franchises %>%\n    mutate(years=cut(year_created,\n                     breaks=c(1920,1929,1939,1949,\n                              1959,1969,1979,1989,\n                              1999,2009,2017),\n                     labels=c(\"1920s\",\"1930s\",\"1940s\",\"1950s\",\n                              \"1960s\",\"1970s\",\"1980s\",\"1990s\",\n                              \"2000s\",\"2010s\"))) %>%\n    group_by(years,revenue_category) %>%\n    summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%\nggplot(.,aes(x=str_wrap(revenue_category,10),y=revenue_total,fill=revenue_avg))+\n    xlab(\"Revenue Category\")+ylab(\"Revenue Total\")+geom_col()+\n    transition_states(years)+ease_aes(\"linear\")+\n    labs(fill=\"Revenue\\nAverage\")+\n    geom_text(aes(label=revenue_total),vjust=-1)+\n    ggtitle(\"Revenue Total in Billion $ for Revenue Category\",\n            subtitle = \"Year : {closest_state}\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Revenue Cateogry In Decades but with Total Revenue-1.gif)\n:::\n:::\n\n\n\n**THANK YOU**\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}