{
  "hash": "f11acd01f96c933415d8fff08eb785f2",
  "result": {
    "markdown": "---\ntitle: Benchmarking optimization functions in R\nauthor: M.Amalan\ndate: '2018-12-04'\ncategories:\n  - bbmle\n  - Beta-Binomial\n  - fitODBOD\n  - maxLik\n  - mle\n  - mle2\n  - nlm\n  - nlminb\n  - optim\n  - ucminf\ndraft: false\nnumber-sections: false\nformat:\n  html:\n    fig-cap-location: bottom\n---\n\n\n**NOTE : Below post is valid for Package version 1.4.0 and Before. **\n\n\n\n\n\n# Estimating the shape parameters by Maximizing the Log Likelihood value of Beta-Binomial Distribution.\n\n# Introduction \n\nWhen we need to estimate parameters from a discrete distribution or continuous distribution \nor a function we can use the below mentioned R functions. We will be using the technique of maximizing the \nLog Likelihood function or minimizing the Negative Log Likelihood function.  Based on \nthis technique we will compare these R functions because it might benefit people who are struggling\nwhich one to choose. We have 7 functions in total by my knowledge when I was writing this blog post. \n\nUsing the [fitODBOD](https://cran.r-project.org/package=fitODBOD) package, I will use the Alcohol Consumption data to try \nand model it for the Beta-Binomial Distribution, which has two shape parameters to estimate. The process is that\nwe find values for shape parameters a and b (or $\\alpha$ and $\\beta$) which will maximize the Log \nLikelihood function of Beta Binomial Distribution or in our case minimize the Negative Log Likelihood \nfunction of Beta Binomial Distribution.\n\nAbove mentioned Beta-Binomial distribution's Probability Mass Function(PMF) is denoted as\n\n$$P_{BetaBin}(x)= {n \\choose x} \\frac{B(\\alpha+x,n+\\beta-x)}{B(\\alpha,\\beta)} $$\n\nwhere  $n=0,1,2,...$, $x=0,1,2,...,n$ and $\\alpha,\\beta > 0$. Further $x$ is the Binomial Random variable, \na,b(or $\\alpha$, $\\beta$) are shape parameters and $n$ is the binomial trial value. Also B($\\alpha$,$\\beta$) \nis the Beta function. In this distribution we have to estimate the values for a and b. \n\nFurther, using the PMF we can construct the Likelihood function for $\\Omega_{BB}=(\\alpha,\\beta)^T$ as given below: \n\n$$L(\\Omega_{BB}|x)=\\prod_{i=1}^{N} \\binom{n}{x_i} \\frac{B(\\alpha+x_i,n+\\beta-x_i)}{B(\\alpha,\\beta)}$$\n\nwhere N is the Number of observations. Then Negative Log Likelihood function is given as \n\n$$l(\\Omega_{BB}|x)=-\\sum_{i=1}^{N} log\\binom{n}{x_i} + \\sum_{i=1}^{N} log(B(\\alpha+x_i,n+\\beta-x_i)) - Nlog(B(\\alpha,\\beta))$$\n\nIn the package fitODBOD we have the function EstMLEBetaBin which is constructed based on the above \nNegative Log Likelihood function, and we will use it. \n\nWe take Log to transform the Likelihood function values, which will simplify the \ncomputation process and save time. The optimization functions we need to compare will use specific \nmathematical methods to find the most appropriate shape parameter values.\n\nThe functions in question are \n\n1. [optim](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/optim)\n2. [nlm](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlm)\n3. [nlminb](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlminb)\n4. [ucminf](https://www.rdocumentation.org/packages/ucminf/versions/1.1-4/topics/ucminf)\n5. [maxLik](https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxLik)\n6. [mle](https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle)\n7. [mle2](https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2)\n\nFurther, I will focus on the attributes of the above functions. Focusing from which package, Number of Inputs, Number of Outputs, \nTime to complete optimization and Analytical Methods used with the assistance in two tables. Alcohol Consumption data \nhas two sets of frequency values but only values from week 1 will be used. Below is the the Alcohol Consumption data, where number of observations\nis 399 and the Binomial Random variable is a vector of values from zero to seven. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fitODBOD)\nkable(Alcohol_data,\"html\",align=c('c','c','c')) %>%\n  kable_styling(bootstrap_options = c(\"striped\"),font_size = 14,full_width = F) %>%\n  row_spec(0,color = \"blue\") %>%\n  column_spec(1,color = \"red\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;color: blue !important;\"> Days </th>\n   <th style=\"text-align:center;color: blue !important;\"> week1 </th>\n   <th style=\"text-align:center;color: blue !important;\"> week2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 0 </td>\n   <td style=\"text-align:center;\"> 47 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 1 </td>\n   <td style=\"text-align:center;\"> 54 </td>\n   <td style=\"text-align:center;\"> 47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 2 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 3 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 4 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 5 </td>\n   <td style=\"text-align:center;\"> 41 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 6 </td>\n   <td style=\"text-align:center;\"> 39 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 7 </td>\n   <td style=\"text-align:center;\"> 95 </td>\n   <td style=\"text-align:center;\"> 84 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## optim Function\n\n[optim](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#O) is the first function in concern.\n[Documentation](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/optim) \nof the optim function is useful and it indicates that this function is only used on one input situations only. This means our \nEstMLEBetaBin function has to be modified. Reason for this is only the parameters that should be estimated need to be input values\nbut our EstMLEBetaBin function has four parameters which are a,b,x(Binomial Random Variable) and freq(corresponding frequency values). \n\nWhile using optim function first index refers to shape parameter a and second index refers to shape parameter b. Further, we have \nto input the observations or in our case the Binomial random variable values and their respective frequencies. I think it\nis inconvenient to modify the EstMLEBetaBin function, because if we want to estimate parameters for different data-sets it would \nbecome tedious. After modification we have a new function foroptim which can be used for demonstration and comparison.\n\nBelow is the code to estimation and going through the outputs. It should be noted that we have to provide \ninitial parameter values as an input to the optim function, and it is best to provide values in the domain \nof shape parameter values which we want to estimate. \n\nHere the shape parameters a and b are in the region of greater than zero but less than positive infinity \n($+\\infty >a,b>0$). So for the initial parameters of a=0.1 and b=0.2 we are finding parameters which would minimize the Negative\nLog Likelihood function of Beta-Binomial distribution with the Alcohol Consumption data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# new function to facilitate optim criteria\n# only one input but has two elements\nforoptim<-function(a)\n  {\n  EstMLEBetaBin(x=Alcohol_data$Days, freq=Alcohol_data$week1,a=a[1],b=a[2])\n  }\n\n# optimizing values for a,b using default mathematical method\noptim_answer<-optim(par=c(0.1,0.2),fn=foroptim)\n\n# obtaining class of output\nclass(optim_answer)\n\n#length of output\nlength(optim_answer)\n\n# the outputs\noptim_answer$par # estimated values for a, b\noptim_answer$value # minimized function value \noptim_answer$counts  # see the documentation to understand\noptim_answer$convergence # indicates successful completion\noptim_answer$message # additional information\n\n# fitting the Beta-Binomial distribution with estimated shape parameter  values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           optim_answer$par[1],optim_answer$par[2])\n```\n:::\n\n\nSo the foroptim function can be used as above and parameters are estimated for $\\alpha$ and $\\beta$ (or a, b) for the Alcohol Consumption \ndata week 1. Further we have scrutinized the function as below.\n\n* package : stats \n* No of Inputs: 7\n* Minimum required Inputs : 2\n* Class of output : list\n* No of outputs: 5\n* No of Analytical Methods : 6\n* Default Method : Nelder-Mead\n\n## nlm Function\n\n[nlm](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#N) function is also similar to optim \nbut only one analytical method will be used, which is a Newton-type Algorithm. \nHere also there needs to be changes made to our EstMLEBetaBin function as previously. After making those changes \nwe have called the new Negative Log-likelihood function of Beta-Binomial distribution as fornlm. Then we can use the nlm function and estimate \na and b for the initial shape parameter values of 0.1 and 0.2 respectively. \n[Documentation](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlm) \nof nlm function is very useful so that we can understand how it works.\n\nBelow is the code for using nlm function appropriately and fiddling with the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#new function to facilitate nlm criteria\nfornlm<-function(a)\n  {\n  EstMLEBetaBin(x=Alcohol_data$Days, freq=Alcohol_data$week1,a=a[1],a[2])\n  }\n\n#optimizing values for a,b using the only analytical method\nnlm_answer<-nlm(f=fornlm,p=c(0.1,0.2))\n\n#obtaining class of output\nclass(nlm_answer)\n\n#length of output\nlength(nlm_answer)\n\n# the outputs\nnlm_answer$estimate # estimated values for a, b\nnlm_answer$minimum # minimized function value \nnlm_answer$gradient  # gradient at the estimated minimum of given funciton\nnlm_answer$code # indicates successful completion\nnlm_answer$iterations # number of iterations performed\n\n# fitting the Beta-Binomial distribution with estimated shape parameter  values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           nlm_answer$estimate[1],nlm_answer$estimate[2])\n```\n:::\n\n\nSimilarly for the fornlm function we have estimated values for a and b which would fit the Alcohol consumption data\nof week 1. Below is a point form summary of nlm function.\n\n* package : stats \n* No of Inputs: 12\n* Minimum required Inputs : 2\n* Class of output : list\n* No of outputs: 5\n* No of Analytical Methods : 1\n* Default Method : Newton-type Algorithm\n\n## nlminb Function\n\n[nlminb](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html#N) is also similar and \nrequires the EstMLEBetaBin function to be restructured as similar to previous situations. \nAfter this task we now have a function called fornlminb. nlminb function is based on analytical method of \nunconstrained and box-constrained optimization using PORT routines.\n\nAfter choosing initial parameter values for a and b, which are respectively 0.1 and 0.2 the estimation was done \nfollowing the process below\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# new function to facilitate nlminb criteria\nfornlminb<-function(a)\n  {\n  EstMLEBetaBin(x=Alcohol_data$Days, freq=Alcohol_data$week1,a=a[1],a[2])\n}\n\n# optimizing values for a,b using default analytical method\nnlminb_answer<-nlminb(start=c(0.1,0.2), objective=fornlminb)\n\n# obtaining class of output\nclass(nlminb_answer)\n\n# length of output\nlength(nlminb_answer)\n\n# the outputs\nnlminb_answer$par # estimated values for a, b\nnlminb_answer$objective # minimized function value \nnlminb_answer$evaluations  # see the documentation to understand\nnlminb_answer$convergence # indicates successful completion\nnlminb_answer$message # additional information\nnlminb_answer$iterations # number of iterations performed\n\n# fitting the Beta-Binomial distribution with estimated shape parameter values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           nlminb_answer$par[1],nlminb_answer$par[2])\n```\n:::\n\n\n[Documentation](https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/nlminb) \nincludes the information related to the function therefore referring it will \nbe useful. After estimating values for a and b using nlminb function these were noticed regarding\nthe function in concern\n\n* package : stats \n* No of Inputs: 8\n* Minimum required Inputs : 2\n* Class of output : list\n* No of outputs: 6\n* No of Analytical Methods : 1\n* Default Method : Unconstrained and box-constrained optimization using PORT routines\n\n## ucminf Function\n\nPackage [ucminf](https://cran.r-project.org/package=ucminf) produces the ucminf function, as previously mentioned functions here also\nwe have to change the EstMLEBetaBin function. After making the changes we will be using the\nforucminf function to the estimation process of shape parameters a and b. \n\nWhen initial parameter values are set to a=0.1 and b=0.2 we will obtain results from \nucminf function, which will minimize the Negative Log-likelihood value of Beta-Binomial distribution.\nBelow is the code for estimation and using the results to understand the function ucminf.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ucminf)\n\n# new function to facilitate ucminf criteria\nforucminf<-function(a)\n  {\n  EstMLEBetaBin(x=Alcohol_data$Days,freq = Alcohol_data$week1,a=a[1],a[2])\n}\n\n# optimizing values for a,b using default analytical method\nucminf_answer<-ucminf(par=c(0.1,0.2),fn=forucminf)\n\n#obtaining class\nclass(ucminf_answer)\n\n# length of output\nlength(ucminf_answer)\n\n# the outputs\nucminf_answer$par # estimated values for a, b\nucminf_answer$value # minimized function value \nucminf_answer$invhessian.lt  # see the documentation understand\nucminf_answer$convergence # indicates successful completion\nucminf_answer$message # additional information\nucminf_answer$info\n\n# fitting the Beta-Binomial distribution with estimated shape parameter values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           ucminf_answer$par[1],ucminf_answer$par[2])\n```\n:::\n\n\nWith the help of R [Documentation](https://www.rdocumentation.org/packages/ucminf/versions/1.1-4/topics/ucminf) the \nestimation was done for shape parameter values a and b using the ucminf function. Below is the initial understanding of\nthe ucminf function \n\n* package : ucminf\n* No of Inputs: 5\n* Minimum required Inputs : 2\n* Class of output : list\n* No of outputs: 6\n* No of Analytical Methods : 1\n* Default Method : Quasi-Newton Algorithm type with BFGS updating\n\n## maxLik Function\n\nmaxLik function is from the [maxLik](https://cran.r-project.org/package=maxLik) package, which only \nmaximizes the Log Likelihood function. Therefore we have to restructure EstMLEBetaBin as previously mentioned, but as \nan addition a negative sign is added for the output. This new function will be called as formaxLik. \n\nFor the initial parameter values where a=0.1 and b=0.2 the maxLik function will be used and \nresults will be evaluated as below. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(maxLik)\n\n# new function to facilitate maxLik criteria\nformaxLik<-function(a)\n  {\n  -EstMLEBetaBin(x=Alcohol_data$Days,freq = Alcohol_data$week1,a=a[1],a[2])\n  }\n\n# optimizing values for a,b using default analytical method\nmaxLik_answer<-maxLik(logLik =formaxLik, start = c(0.1,0.2))\n\n# obtaining class of output\nclass(maxLik_answer)\n\n# length of output\nlength(maxLik_answer)\n\n# the outputs\nmaxLik_answer$estimate # estimated values for a, b\nmaxLik_answer$maximum # minimized function value \nmaxLik_answer$iterations  # no of iterations to succeed\nmaxLik_answer$gradient # last gradient value which was calculated\nmaxLik_answer$message # additional information\nmaxLik_answer$hessian # hessian matrix\nmaxLik_answer$code # indicates successful completion\nmaxLik_answer$fixed # logical vector indicating which parameters are constants\nmaxLik_answer$type # type of maximization\nmaxLik_answer$last.step # list describing the last unsuccessful step\nmaxLik_answer$control # see the documentation understand\n\n# fitting the Beta-Binomial distribution with estimated shape parameter values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           maxLik_answer$estimate[1],maxLik_answer$estimate[2])\n```\n:::\n\n\nUsing the [Documentation](https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxLik) of maxLik\nand the [Documentation](https://www.rdocumentation.org/packages/maxLik/versions/1.3-4/topics/maxNR) of \nmaxNR function the above analysis was done for the maxLik function. According to the above code, below are the findings from the maxLik \nfunction in point form \n\n* package : maxLik\n* No of Inputs: 6\n* Minimum required Inputs : 2\n* Class of output : list or class of maxim or class of maxLik\n* No of outputs: 11\n* No of Analytical Methods : 7\n* Default Method : Automatically chosen\n\n## mle Function\n\n[stats4](https://stat.ethz.ch/R-manual/R-devel/library/stats4/html/00Index.html) package is installed so that mle function can be operated for the purpose of \nestimating a and b parameters. Here also as previously we need to make some changes \nas below and create a new Negative Log Likelihood function called formle. \n\nFor the initial parameter values of a=0.1 and b=0.2 the Negative Log Likelihood value of Beta-Binomial distribution\nhas been minimized using mle function. Below is the code for estimation and investigation\nfrom the outputs of mle after estimation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stats4)\n\n# new function to facilitate mle criteria\nformle<-function(a,b)\n  {\n  EstMLEBetaBin(x=Alcohol_data$Days,freq = Alcohol_data$week1,a,b)\n  }\n\n# optimizing values for a,b using default analytical method\nmle_answer<-mle(minuslogl=formle,start = list(a=0.1,b=0.2))\n\n# obtaining class\nclass(mle_answer)\n\n# length of output\nlength(mle_answer)\n\n# the outputs\nmle_answer@call # inputs i have used \nmle_answer@coef # estimated values for a,b\nmle_answer@fullcoef # all values, even the fixed values we did not want to estimate\nmle_answer@vcov # variance covariance matrix for a,b\nmle_answer@min # minimized function value\nmle_answer@details # details after estimation process\nmle_answer@nobs # number of observations to be used for computing only if given \nmle_answer@method # optimization methods used\n\n# Methods used\nconfint(mle_answer) # confidence intervals for estimated values\nlogLik(mle_answer) # Negative loglikelihood value for estimated values \nprofile(mle_answer) # Likelihood profile generation.\nnobs(mle_answer) # number of observations to be used for computing only if given\nshow(mle_answer) # display object briefly\nsummary(mle_answer) # generate a summary\n#update()   # updating if we have new data and need to estimate new values\nvcov(mle_answer) # variance covariance matrix\n\n# fitting the Beta-Binomial distribution with estimated shape parameter values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           mle_answer@coef[1],mle_answer@coef[2])\n```\n:::\n\n\nIt should be noted that in all 5 previous functions we had only outputs in the form of lists, but\nthrough mle we are seeing a class of mle output.The [Documention](https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle) \nexplains the inputs and outputs of mle. [Documentation](https://www.rdocumentation.org/packages/stats4/versions/3.5.1/topics/mle-class) \nfor mle-class explains further about the methods that can be used. Below is a list of findings \nbased on the outputs of the mle function.\n\n* package : stats4\n* No of Inputs: 5\n* Minimum required Inputs : 2\n* Class of output : class of mle\n* No of outputs: 9\n* Methods for output: 8 \n* No of Analytical Methods :6\n* Default Method : Nelder and Mead\n\n## mle2 Function\n\nmle2 function is advanced than mle function and it is from the package [bbmle](https://cran.r-project.org/package=bbmle). \nHere, there is no need to modify the EstMLEBetabin function from the fitODBOD package \nto estimation as all previous situations . \n\nFor the initial parameter values of a=0.1 and b=0.2 Negative Log Likelihood function of Beta-Binomial distribution will be\nminimized where outputs will be investigated and methods related to output of class mle2 will be used.\n\nBelow is the code for using mle2 function and scrutinizing the output and methods \nrelated to it. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bbmle)\n\n# optimizing values for a,b using default analytical method\nmle2_answer<-mle2(minuslogl= EstMLEBetaBin,start = list(a=0.1,b=0.2),\n                  data = list(x=Alcohol_data$Days,freq=Alcohol_data$week1))\n\n# obtaining class\nclass(mle2_answer)\n\n# length of output\nlength(mle2_answer)\n\n# the outputs\nmle2_answer@call # inputs generally considered \nmle2_answer@call.orig # inputs i have given\nmle2_answer@coef # estimated values for a,b\nmle2_answer@fullcoef # all values, even the fixed values we did not want to estimate\nmle2_answer@vcov # variance covariance matrix for a,b\nmle2_answer@min # minimized function value\nmle2_answer@details # details after estimation process\nmle2_answer@method # optimization methods used\nmle2_answer@data # data used for estimation \nmle2_answer@formula # if a formula was specified in the input \nmle2_answer@optimizer # function used for optimizing\n\n# Methods used\ncoef(mle2_answer) # extrat the estimated values\nconfint(mle2_answer) # confidence intervals for estimated values\nshow(mle2_answer) # display object briefly\nsummary(mle2_answer) # generate a summary\n#update()   #updating if we have new data and need to estimate new values\nvcov(mle2_answer) # variance covariance matrix\n#formula(mle2_answer) # if a formula was specified in the input \n#plot(mle2_answer) # plot the profile\nlogLik(mle2_answer) # Negative loglikelihood value for estimated values \nprofile(mle2_answer) # profile of estimated values\n\n# fitting the Beta-Binomial distribution with estimated shape parameter values\nfitBetaBin(Alcohol_data$Days,Alcohol_data$week1,\n           mle2_answer@coef[1],mle2_answer@coef[2])\n```\n:::\n\n\n[Documention](https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2) of\nmle2 function and [Documentation](https://www.rdocumentation.org/packages/bbmle/versions/1.0.20/topics/mle2-class) of mle2-class  \nprovide a few findings as mentioned below in point form.\n\n* package : bbmle\n* No of Inputs: 22\n* Minimum required Inputs : 3\n* Class of output : class of mle2\n* No of outputs: 12\n* Methods for output: 9\n* No of Analytical Methods : 6\n* Default Method : Nelder and Mead\n\n# Summary of the seven optimization functions in R \n\nAfter completing a brief fact finding of the R functions optim, nlm, nlminb, ucminf, \nmaxLik, mle and mle2. We can record the facts and results in two tables. Using them\nwe can choose the best suitable function for our needs of estimation from optimization.\n\nMostly I prefer mle2 function than others because it provides special methods to handle\nthe mle2 outputs, and the output themselves are very thorough than other R function outputs. \n\nIt can be seen that estimated a and b shape parameter values are different only \nfrom the third decimal point in all outputs. But this does not effect the \nminimized Negative Log Likelihood value of Beta-Binomial distribution for our Alcohol\nConsumption data, which is same for all outputs.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;color: blue !important;\"> Function </th>\n   <th style=\"text-align:center;color: blue !important;\"> optim </th>\n   <th style=\"text-align:center;color: blue !important;\"> nlm </th>\n   <th style=\"text-align:center;color: blue !important;\"> nlminb </th>\n   <th style=\"text-align:center;color: blue !important;\"> ucminf </th>\n   <th style=\"text-align:center;color: blue !important;\"> maxLik </th>\n   <th style=\"text-align:center;color: blue !important;\"> mle </th>\n   <th style=\"text-align:center;color: blue !important;\"> mle2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Package </td>\n   <td style=\"text-align:center;\"> stats </td>\n   <td style=\"text-align:center;\"> stats </td>\n   <td style=\"text-align:center;\"> stats </td>\n   <td style=\"text-align:center;\"> ucminf </td>\n   <td style=\"text-align:center;\"> maxLik </td>\n   <td style=\"text-align:center;\"> stats4 </td>\n   <td style=\"text-align:center;\"> bbmle </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> No of Inputs </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Minimum No of Inputs </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Analytical Methods </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Output Type </td>\n   <td style=\"text-align:center;\"> List </td>\n   <td style=\"text-align:center;\"> List </td>\n   <td style=\"text-align:center;\"> List </td>\n   <td style=\"text-align:center;\"> List </td>\n   <td style=\"text-align:center;\"> List \nclass maxLik \nclass maxim </td>\n   <td style=\"text-align:center;\"> class mle </td>\n   <td style=\"text-align:center;\"> class mle2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> No of Outputs </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> No of Methods </td>\n   <td style=\"text-align:center;\"> None </td>\n   <td style=\"text-align:center;\"> None </td>\n   <td style=\"text-align:center;\"> None </td>\n   <td style=\"text-align:center;\"> None </td>\n   <td style=\"text-align:center;\"> None </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Initial value(a,b) </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n   <td style=\"text-align:center;\"> a=0.1\nb=0.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Estimated value(a,b) </td>\n   <td style=\"text-align:center;\"> a=0.7230707 \nb=0.5809894 </td>\n   <td style=\"text-align:center;\"> a=0.7229384 \nb=0.5808448 </td>\n   <td style=\"text-align:center;\"> a=0.7229404 \nb=0.5808469 </td>\n   <td style=\"text-align:center;\"> a=0.7229390 \nb=0.5808458 </td>\n   <td style=\"text-align:center;\"> a=0.7229428 \nb=0.5808488 </td>\n   <td style=\"text-align:center;\"> a=0.7228930 \nb=0.5807279 </td>\n   <td style=\"text-align:center;\"> a=0.7228930 \nb=0.5807279 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Negative Log Likelihood value </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n   <td style=\"text-align:center;\"> 813.4571 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Summary of Time evaluation for the seven optimization R functions\n\nFurther at the beginning I have mentioned to evaluate the system process time \nfor the seven functions. In order to do this time comparison it is possible to use the [benchmark](https://www.rdocumentation.org/packages/rbenchmark/versions/1.0.0/topics/benchmark) \nfunction of [rbenchmark](https://cran.r-project.org/package=rbenchmark) \npackage, and below mentioned code chunk provides the output in a table form. \nIt includes the functions and their respective time values. The estimation \nprocess of the parameters where each function has been replicated 1000 times to receive a\nmore accurate table of time values. \n\nThe table is in ascending order according to the elapsed time values column. According to this we \ncan see that least time takes to the nlminb function and most time is taken to the mle2 function. These \ntimes completely depends on the Negative Log Likelihood function you need to minimize, the data you provided,\nthe number of estimators that needs to be estimated, the complexity of the function and finally your computer's \nprocessing power. \n\nTherefore based on the needs of your output and the function which needs estimation choose the best function out of the above seven.\nBecause as I said related to the earlier table the estimated values are slightly different but does not make any strong influence \non the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rbenchmark)\n\nResults2<-benchmark(\n          \"optim\"={optim(par = c(0.1,0.2), fn = foroptim)},\n          \"nlm\"={nlm(f = fornlm, p = c(0.1,0.2))},\n          \"nlminb\"={nlminb(start = c(0.1,0.2), objective = fornlminb)},\n          \"ucminf\"={ucminf(par = c(0.1,0.2), fn = forucminf)},\n          \"maxLik\"={maxLik(logLik = formaxLik, start = c(0.1,0.2))},\n          \"mle\"={mle(minuslogl = formle, start = list(a=0.1,b=0.2))},\n          \"mle2\"={mle2(minuslogl = EstMLEBetaBin, start = list(a=0.1, b=0.2),\n                       data = list(x=Alcohol_data$Days, freq=Alcohol_data$week1))},\n          replications = 1000,\n          columns = c(\"test\",\"replications\",\"elapsed\",\n                      \"relative\",\"user.self\",\"sys.self\"),\n          order = 'elapsed'\n          )\n\nkable(Results2,\"html\",align = c('c','c','c','c','c','c')) %>%\n  kable_styling(full_width = F,bootstrap_options = c(\"striped\"),font_size = 10) %>%\n  row_spec(0,color = \"blue\") %>%\n  column_spec(1,color = \"red\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;color: blue !important;\">   </th>\n   <th style=\"text-align:center;color: blue !important;\"> test </th>\n   <th style=\"text-align:center;color: blue !important;\"> replications </th>\n   <th style=\"text-align:center;color: blue !important;\"> elapsed </th>\n   <th style=\"text-align:center;color: blue !important;\"> relative </th>\n   <th style=\"text-align:center;color: blue !important;\"> user.self </th>\n   <th style=\"text-align:center;color: blue !important;\"> sys.self </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 3 </td>\n   <td style=\"text-align:center;\"> nlminb </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 6.11 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> 6.01 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 4 </td>\n   <td style=\"text-align:center;\"> ucminf </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 7.19 </td>\n   <td style=\"text-align:center;\"> 1.177 </td>\n   <td style=\"text-align:center;\"> 7.14 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 2 </td>\n   <td style=\"text-align:center;\"> nlm </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 8.00 </td>\n   <td style=\"text-align:center;\"> 1.309 </td>\n   <td style=\"text-align:center;\"> 8.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 1 </td>\n   <td style=\"text-align:center;\"> optim </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 9.80 </td>\n   <td style=\"text-align:center;\"> 1.604 </td>\n   <td style=\"text-align:center;\"> 9.77 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 6 </td>\n   <td style=\"text-align:center;\"> mle </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 21.25 </td>\n   <td style=\"text-align:center;\"> 3.478 </td>\n   <td style=\"text-align:center;\"> 21.03 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 5 </td>\n   <td style=\"text-align:center;\"> maxLik </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 33.68 </td>\n   <td style=\"text-align:center;\"> 5.512 </td>\n   <td style=\"text-align:center;\"> 33.25 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: red !important;\"> 7 </td>\n   <td style=\"text-align:center;\"> mle2 </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 34.88 </td>\n   <td style=\"text-align:center;\"> 5.709 </td>\n   <td style=\"text-align:center;\"> 34.22 </td>\n   <td style=\"text-align:center;\"> 0.48 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Summary of Results after estimating parameters using the optimization R functions\n\nAfter using the functions optim, nlm, nlminb, ucminf, maxLik, mle and mle2 to estimate\nthe shape parameters a, b we can use the estimated parameters in the function fitBetaBin.\nUsing this function we can find expected frequencies for each of the estimated parameters a,b and \ncompare p-values and over-dispersion and understand if using different optimization functions had\nany effect on them.\n\nAccording to the below table there is no significant changes between the expected frequencies,\np-values or the over dispersion values. This is a clear indication that it does not matter what function we\nuse for the optimization. Because the process will occur effectively only efficiency(time) will be affected.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;color: blue !important;\"> BinomialRandomVariable </th>\n   <th style=\"text-align:center;color: blue !important;\"> Frequency </th>\n   <th style=\"text-align:center;color: blue !important;\"> optim </th>\n   <th style=\"text-align:center;color: blue !important;\"> nlm </th>\n   <th style=\"text-align:center;color: blue !important;\"> nlminb </th>\n   <th style=\"text-align:center;color: blue !important;\"> ucminf </th>\n   <th style=\"text-align:center;color: blue !important;\"> maxLik </th>\n   <th style=\"text-align:center;color: blue !important;\"> mle </th>\n   <th style=\"text-align:center;color: blue !important;\"> mle2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 0 </td>\n   <td style=\"text-align:center;\"> 47 </td>\n   <td style=\"text-align:center;\"> 54.61 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n   <td style=\"text-align:center;\"> 54.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 1 </td>\n   <td style=\"text-align:center;\"> 54 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 2 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 38.91 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n   <td style=\"text-align:center;\"> 38.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 3 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n   <td style=\"text-align:center;\"> 38.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 4 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n   <td style=\"text-align:center;\"> 40.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 5 </td>\n   <td style=\"text-align:center;\"> 41 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 43.99 </td>\n   <td style=\"text-align:center;\"> 43.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 6 </td>\n   <td style=\"text-align:center;\"> 39 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n   <td style=\"text-align:center;\"> 53.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> 7 </td>\n   <td style=\"text-align:center;\"> 95 </td>\n   <td style=\"text-align:center;\"> 87.77 </td>\n   <td style=\"text-align:center;\"> 87.78 </td>\n   <td style=\"text-align:center;\"> 87.78 </td>\n   <td style=\"text-align:center;\"> 87.78 </td>\n   <td style=\"text-align:center;\"> 87.78 </td>\n   <td style=\"text-align:center;\"> 87.8 </td>\n   <td style=\"text-align:center;\"> 87.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Total No of Observations </td>\n   <td style=\"text-align:center;\"> 399 </td>\n   <td style=\"text-align:center;\"> 398.99 </td>\n   <td style=\"text-align:center;\"> 399 </td>\n   <td style=\"text-align:center;\"> 399 </td>\n   <td style=\"text-align:center;\"> 399.01 </td>\n   <td style=\"text-align:center;\"> 399 </td>\n   <td style=\"text-align:center;\"> 399.01 </td>\n   <td style=\"text-align:center;\"> 399.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> p-value </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.0902 </td>\n   <td style=\"text-align:center;\"> 0.0901 </td>\n   <td style=\"text-align:center;\"> 0.0901 </td>\n   <td style=\"text-align:center;\"> 0.0901 </td>\n   <td style=\"text-align:center;\"> 0.0901 </td>\n   <td style=\"text-align:center;\"> 0.0903 </td>\n   <td style=\"text-align:center;\"> 0.0903 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: red !important;\"> Over Dispersion </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.4340165 </td>\n   <td style=\"text-align:center;\"> 0.4340686 </td>\n   <td style=\"text-align:center;\"> 0.4340679 </td>\n   <td style=\"text-align:center;\"> 0.4340683 </td>\n   <td style=\"text-align:center;\"> 0.434067 </td>\n   <td style=\"text-align:center;\"> 0.4340992 </td>\n   <td style=\"text-align:center;\"> 0.4340992 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Final Conclusion\n\nWe had 7 functions to compare but choosing one over the other is completely harmless\nto the final result of estimation as seen by our tables. The only issue is time, therefore\nI would recommend choose the best function based on your needs of output and research objective.\n\n*THANK YOU*\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}