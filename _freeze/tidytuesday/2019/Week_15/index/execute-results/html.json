{
  "hash": "f5e5164e54fa1b9a20665596a77c8ce8",
  "result": {
    "markdown": "---\ntitle: 'Week 15 : Tennis Tournaments'\ndate: '2019-04-09'\ncategories:\n  - TidyTuesday\n  - 2019\nimage: featured.png\ndraft: false\nnumber-sections: false\nformat:\n  html:\n    fig-cap-location: bottom\nresources: \n  - \"featured.png\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(gganimate)\n\nplayer_dob <- read_csv(\"player_dob.csv\", \n                        col_types = cols(date_of_birth = col_date(format = \"%Y-%m-%d\"), \n                        date_of_first_title = col_date(format = \"%Y-%m-%d\")))\ngrand_slams <- read_csv(\"grand_slams.csv\", \n                        col_types = cols(gender = col_factor(levels = c(\"Female\",\"Male\")), \n                        rolling_win_count = col_integer(), \n                        tournament_date = col_date(format = \"%Y-%m-%d\"), \n                        year = col_integer()))\ngrand_slam_timeline <- read_csv(\"grand_slam_timeline.csv\", \n                                col_types = cols(gender = col_factor(levels = c(\"Female\",\"Male\")), \n                                year = col_integer()))\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n{{% tweet \"1115652786862153729\" %}}\n```\n:::\n:::\n\n\n[GitHub Code](https://github.com/Amalan-ConStat/TidyTuesday/tree/master/2019/Week15)\n\n# Player Information\n\n## Decade of Birth vs First Grand Slam Title Won\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayer_dob %>% \n   remove_missing() %>%\n   mutate(grand_slam=recode_factor(grand_slam,\n                                  'Wimbledon'=\"Wimbledon\",\n                                  'US Open'=\"US Open\",\n                                  'French Open'=\"French Open\",\n                                  'Australian Open'=\"Aus Open\",\n                                  'Australian Open (January)'=\"Aus Open\",\n                                  'Australian Open (Jan)'=\"Aus Open\",       \n                                  'Australian Open (December)'=\"Aus Open\",  \n                                  'Australian Open (Jan.)'=\"Aus Open\"                                  \n                                  )) %>%\n  mutate(Birth=year(date_of_birth)) %>%\n  mutate(Birth=cut(Birth,breaks = c(1929,1939,1949,1959,1969,1979,1989,1999),\n                   labels = c(1930,1940,1950,1960,1970,1980,1990)\n                   )) %>%\n  group_by(Birth,grand_slam) %>%\n  count()  %>%\nggplot(.,aes(x=factor(Birth),y=n,fill=grand_slam))+\n      geom_col(position = \"dodge\")+\n      scale_y_continuous(breaks=seq(1,11,1),labels=seq(1,11,1))+\n      labs(fill=\"Grand Slam\")+\n      geom_text(aes(label=n),position = position_dodge(width = 1),vjust=1)+\n      xlab(\"Decade of Birth\")+ylab(\"Count\")+\n      ggtitle(\"How Decade of Birth and First Win of Grand Slam changes\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/decade of birth vs first title won-1.png){width=1152}\n:::\n:::\n\n\n## Decade of Birth vs First Grand Slam with Age\n \n\n::: {.cell}\n\n```{.r .cell-code}\nplayer_dob %>% \n  remove_missing() %>%\n  mutate(grand_slam=recode_factor(grand_slam,\n                                  'Wimbledon'=\"Wimbledon\",\n                                  'US Open'=\"US Open\",\n                                  'French Open'=\"French Open\",\n                                  'Australian Open'=\"Aus Open\",\n                                  'Australian Open (January)'=\"Aus Open\",\n                                  'Australian Open (Jan)'=\"Aus Open\",       \n                                  'Australian Open (December)'=\"Aus Open\",  \n                                  'Australian Open (Jan.)'=\"Aus Open\"                                  \n                                  )) %>%\n  mutate(Birth=year(date_of_birth)) %>%\n  mutate(Birth=cut(Birth,breaks = c(1929,1939,1949,1959,1969,1979,1989,1999),\n                   labels = c(1930,1940,1950,1960,1970,1980,1990)\n                   )) %>%\nggplot(.,aes(x=grand_slam,size=round(age/365),y=Birth))+\n       geom_jitter()+\n       xlab(\"Grand Slam\")+ylab(\"Decade of Birth\")+\n       labs(color=\"Age\",size=\"Age in Years\")+\n       ggtitle(\"Birth Decade vs First Grand Slam with Age\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/grand slams , Decade of Birth and age-1.png){width=1152}\n:::\n:::\n\n \n# Grand Slams\n\n## Gender vs Grand Slam with Name\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slams %>%\n      group_by(name,gender) %>%\n      count(sort = TRUE) %>%\n      head(25) %>%\n      ggplot(.,aes(x=fct_inorder(name),y=n,\n                   fill=gender,label=n))+\n      geom_col()+xlab(\"Name\")+ylab(\"Count\")+\n      labs(fill=\"Gender\")+\n      coord_flip()+geom_text(hjust =1)+\n      ggtitle(\"Who won most with Gender\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/gender vs grand slam with name-1.png){width=1152}\n:::\n:::\n\n\n## Gender vs Grand Slam with Year\n\n\n::: {.cell}\n\n```{.r .cell-code}\np<-grand_slams %>%\n      ggplot(.,aes(x=name,y=rolling_win_count,\n                   shape=gender,color=grand_slam))+\n      geom_point()+\n      xlab(\"Name\")+ylab(\"Cumulative Count\")+\n      labs(color=\"Grand Slam\",shape=\"Gender\")+\n      transition_time(tournament_date)+ease_aes(\"linear\")+\n      coord_flip()+shadow_mark()+\n      ggtitle(\"Cumulative progress with Year: {year(frame_time)}\")\n\nanimate(p,nframes = 52,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/gender vs grand slam with year-1.gif)\n:::\n:::\n\n\n# Grand Slam Timeline\n\n## Top 10 players and their Outcomes \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop10<-grand_slams %>%\n       group_by(name) %>%\n       count(sort = TRUE) %>%\n       head(10) %>%\n       select(name)\n\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      group_by(name,outcome) %>%\n      count() %>%\nggplot(.,aes(name,n,fill=outcome))+\n      geom_col(position=position_dodge(width = 0.95))+\n      geom_text(aes(label=n),position = position_dodge(width = 0.95),hjust=1)+\n      coord_flip()+labs(fill=\"Outcome\")+\n      xlab(\"Name\")+ylab(\"Count\")+\n      ggtitle(\"Top 10 Tennis Players and their Outcomes\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis player and outcomes-1.png){width=1152}\n:::\n:::\n\n\n## Top 10 Players and Tournament with outcomes of activeness\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      group_by(tournament,outcome) %>%\n      count() %>%\nggplot(.,aes(x=tournament,y=n,fill=outcome))+\n      geom_col(position =position_dodge(width=0.95))+\n      geom_text(aes(label=n),position =position_dodge(width=0.95),vjust=1)+\n      labs(fill=\"Outcome\")+\n      xlab(\"Tournament\")+ylab(\"Count\")+\n      ggtitle(\"Tournament perspective of Top 10 Tennis Players and their Outcomes\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis Players and outome-1.png){width=1152}\n:::\n:::\n\n\n## Top 10 Players Winning based on Tournament\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      subset(outcome==\"Won\") %>%\n      group_by(name,tournament) %>%\n      count() %>%\nggplot(.,aes(x=name,y=n,fill=tournament))+\n      geom_col(position =position_dodge(width=0.95))+\n      geom_text(aes(label=n),position =position_dodge(width=0.95),hjust=1)+\n      coord_flip()+\n      labs(fill=\"Tournament\")+\n      xlab(\"Name\")+ylab(\"Count\")+\n      ggtitle(\"Winning, Top 10 Tennis Players with related to Tournament\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis Players Winning-1.png){width=1152}\n:::\n:::\n\n\n\n## Top 10 Players Finalist based on Tournament\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      subset(outcome==\"Finalist\") %>%\n      group_by(name,tournament) %>%\n      count() %>%\nggplot(.,aes(x=name,y=n,fill=tournament))+\n      geom_col(position =position_dodge(width=0.95))+\n      geom_text(aes(label=n),position =position_dodge(width=0.95),hjust=1)+\n      coord_flip()+\n      labs(fill=\"Tournament\")+\n      xlab(\"Name\")+ylab(\"Count\")+\n      ggtitle(\"Finalist, Top 10 Tennis Players with related to Tournament\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis Players Finalist-1.png){width=1152}\n:::\n:::\n\n\n## Top 10 Players Semi-Finalist based on Tournament\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      subset(outcome==\"Semi-finalist\") %>%\n      group_by(name,tournament) %>%\n      count() %>%\nggplot(.,aes(x=name,y=n,fill=tournament))+\n      geom_col(position =position_dodge(width=0.95))+\n      geom_text(aes(label=n),position =position_dodge(width=0.95),hjust=1)+\n      coord_flip()+\n      labs(fill=\"Tournament\")+\n      xlab(\"Name\")+ylab(\"Count\")+\n      ggtitle(\"Semi-Finalist, Top 10 Tennis Players with related to Tournament\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis Players Semi-Finalist-1.png){width=1152}\n:::\n:::\n\n\n## Top 10 Players Retired based on Tournament\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_slam_timeline %>%\n      rename(name=\"player\") %>%\n      inner_join(top10,\"name\") %>%\n      subset(outcome==\"Retired\") %>%\n      group_by(name,tournament) %>%\n      count() %>%\nggplot(.,aes(x=name,y=n,fill=tournament))+\n      geom_col(position =position_dodge(width=0.95))+\n      geom_text(aes(label=n),position =position_dodge(width=0.95),hjust=1)+\n      coord_flip()+\n      labs(fill=\"Tournament\")+\n      xlab(\"Name\")+ylab(\"Count\")+\n      ggtitle(\"Retired, Top 10 Tennis Players with related to Tournament\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Top 10 Tennis Players Retired-1.png){width=1152}\n:::\n:::\n\n\n*THANK YOU*\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}