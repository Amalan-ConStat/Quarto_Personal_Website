{
  "hash": "88c28c96e941116504c425b93df38638",
  "result": {
    "markdown": "---\ntitle: 'Week 5: Dairy Products in USA'\ndate: '2019-01-29'\ncategories:\n  - TidyTuesday\n  - 2019\nimage: featured.png\ndraft: false\nnumber-sections: false\nformat:\n  html:\n    fig-cap-location: bottom\nresources: \n  - \"featured.png\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the packages\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(ggthemr)\nlibrary(readr)\nlibrary(gganimate)\nlibrary(usmap)\n\n# load the data\nfluid_milk_sales <- read_csv(\"fluid_milk_sales.csv\")\nstate_milk_production <- read_csv(\"state_milk_production.csv\")\nclean_cheese <- read_csv(\"clean_cheese.csv\")\n\n# load the theme\nggthemr(\"flat dark\")\n```\n:::\n\n\n# Introduction\n\n5 data-sets are given here, but I will be only discussing 3. They are Fluid Milk Sales, State Milk\nproduction and Clean Cheese. Clean Cheese has only few rows (48) and few columns (17). This is not \nthe case in Fluid Milk Sales and State Milk production. \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n{{% tweet \"1090266660785729536\" %}}\n```\n:::\n:::\n\n\n[GitHub Code](https://github.com/Amalan-ConStat/TidyTuesday/tree/master/2019/Week5)\n\n# Fluid Milk Sales\n\nFluid Milk Sales has information for 9 different types of milk and how their Consumption in Pounds\nhas changed over time from 1970 to 2017. We can see how Whole and Reduced Fat(2%) type milk are \nchanging over the years with significant amount. Further, We can see how other types \nare changing from the initial order in 1970 of lower(Eggnog) amount to higher(Whole) amount in pounds\nover the years. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(fluid_milk_sales)\n\nfluid_milk_sales$pounds<-fluid_milk_sales$pounds/(10^7)\n\n# how sales change over the years for 9 different types of milk\np<-ggplot(fluid_milk_sales,aes(x=fct_inorder(milk_type) ,y=pounds,fill=year))+\n       geom_bar(stat=\"identity\")+\n        transition_time(year)+ease_aes(\"linear\")+\n       xlab(\"Milk Type\")+ylab(\"Pounds (in 10^7)\")+\n       coord_flip()+\n       ggtitle(\"Milk Type vs Pounds in year: {round(frame_time)}\")\n\nanimate(p,nframes=48,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Fluid milk Sales-1.gif)\n:::\n\n```{.r .cell-code}\ndetach(fluid_milk_sales)\n```\n:::\n\n\n# State Milk Production\n\nIn the 48 years we are separating them by 24 years each for a plot.\nUsing [usmap](https://cran.r-project.org/web/packages/usmap/index.html) package I am going to plot it into their respective \nstates in perspective of Milk Produced lbs in 10^6.\n\n## US States and Milk Production Over the Years\n\nIn the first half of 1970 to 1993 we can see how a few states are having \nsteady increase over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(state_milk_production)\n\n# dividing the milk produced by 10^6\n#summary(state_milk_production$milk_produced)\nstate_milk_production$milk_produced<-state_milk_production$milk_produced/(10^6)\n\n# plot in us map the milk produced by state for years 1970 to 1993\nplot_usmap(data=subset(state_milk_production,year <=\"1993\"),values = \"milk_produced\")+\n          facet_wrap(~factor(year),ncol = 4)+\n          ggtitle(\"Over the years Milk production changing in USA\")+\n          theme(legend.position = \"left\")+\n          labs(fill=\"lbs in 10^6\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/State Milk production Us Map-1.png){width=1344}\n:::\n:::\n\n\nThis is similar to the next half which is from 1994 to 2017 as well. Similar increase\noccurs for the above same states as I see in the below plot. Well it is not very accurately \ndescribed in the two plots for us to see.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot in us map the milk produced by state for years 1994 to 2017\nplot_usmap(data=subset(state_milk_production,year >\"1993\"),values = \"milk_produced\")+\n          facet_wrap(~factor(year),ncol = 4)+\n          ggtitle(\"Over the years Milk production changing in USA\")+\n          theme(legend.position = \"left\")+\n          labs(fill=\"lbs in 10^6\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/State Milk production Us Map 1-1.png){width=1344}\n:::\n:::\n\n\nTo understand the above same change over the years clearly I have created a bar plot how \nthe increase occurs. This plot also indicates how much change has occurred \nover the 48 years for each state who produces milk. Clearly the states \nCalifornia and Wisconsin have higher increase over the years, which is very\nstrong. There are some states which have not produced more amount each year than their \nprevious years. \n\nThe states Wyoming, Rhode island, Hawaii, Delaware and Alaska have very low amount of\nmilk production over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# over the years how milk production has changed for each year in a bar plot\np<-ggplot(state_milk_production,aes(x=state,y=milk_produced,\n                                    fill=year))+\n      geom_bar(stat=\"identity\")+coord_flip()+\n      transition_time(year)+ease_aes(\"linear\")+shadow_mark()+\n      xlab(\"State\")+ylab(\"Milk Produced (in 10^6)\")+\n      ggtitle(\"States vs Milk Produced in year: {round(frame_time)}\")\n\nanimate(p,nframes = 48,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/State Milk production over the years for states-1.gif)\n:::\n:::\n\n\n## Summing States of Same Regions Over the Years \n\nThere are 50 states but only 10 regions and not all regions have \nequal amount of states. Therefore I am going to sum up the milk\nproduction for all regions over the years and try to understand \nif there is any pattern.\n\nIn order to do this I have used the [dplyr](https://cran.r-project.org/web/packages/dplyr/index.html) package and created a function\nwhich would sum up the production for each region of each year. Similarly,\nthis function has the ability to get the average production for each region\nof each year as well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# manipulating the data by sum and mean\nby_region_sum<-function(i,ch_sum)\n{\n  if(ch_sum==TRUE)\n  {\n    # subsetting by summation over all years for each region\n    temp<-subset(state_milk_production,year==i,select=c(\"region\",\"milk_produced\")) %>%\n                  group_by(region) %>%\n                  summarise_each(funs(sum))\n  \n  output<-data.frame(year=rep(i,10), region=temp$region, milk_produced=temp$milk_produced)\n  }\n  else\n  {\n    # subsetting by Average over all years for each region    \n    temp<-subset(state_milk_production,year==i,select=c(\"region\",\"milk_produced\")) %>%\n                  group_by(region) %>%\n                  summarise_each(funs(mean))\n  \n    output<-data.frame(year=rep(i,10), region=temp$region, milk_produced=temp$milk_produced)\n  }\n  return(output)\n}\n```\n:::\n\n\nUsing the by_region_sum function I am now finding the sum as below. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subsetting by summation\nmilk_region_data<-rbind.data.frame(by_region_sum(1970,T),by_region_sum(1971,T),\n                                   by_region_sum(1972,T),by_region_sum(1973,T),\n                                   by_region_sum(1974,T),by_region_sum(1975,T),\n                                   by_region_sum(1976,T),by_region_sum(1977,T),\n                                   by_region_sum(1978,T),by_region_sum(1979,T),\n                                   by_region_sum(1980,T),by_region_sum(1981,T),\n                                   by_region_sum(1982,T),by_region_sum(1983,T),                   \n                                   by_region_sum(1984,T),by_region_sum(1985,T),               \n                                   by_region_sum(1986,T),by_region_sum(1987,T),                 \n                                   by_region_sum(1988,T),by_region_sum(1989,T),\n                                   by_region_sum(1990,T),by_region_sum(1991,T), \n                                   by_region_sum(1992,T),by_region_sum(1993,T), \n                                   by_region_sum(1994,T),by_region_sum(1995,T), \n                                   by_region_sum(1996,T),by_region_sum(1997,T), \n                                   by_region_sum(1998,T),by_region_sum(1999,T), \n                                   by_region_sum(2000,T),by_region_sum(2001,T),\n                                   by_region_sum(2002,T),by_region_sum(2003,T),   \n                                   by_region_sum(2004,T),by_region_sum(2005,T),                 \n                                   by_region_sum(2006,T),by_region_sum(2007,T), \n                                   by_region_sum(2008,T),by_region_sum(2009,T),\n                                   by_region_sum(2010,T),by_region_sum(2011,T),\n                                   by_region_sum(2012,T),by_region_sum(2013,T),\n                                   by_region_sum(2014,T),by_region_sum(2015,T),\n                                   by_region_sum(2016,T),by_region_sum(2017,T)                  \n                                   )\n```\n:::\n\n\nIf we consider the summation we can see clearly how centered and very limited variation is there for some \nregions such as Southeast, Northern Plains, Delta States, Corn Belt and Appalachian. There is some variation\nin the Northeast region. Clear and highest variation is in for Pacific, Mountain and Lake States regions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Region wise total milk production changing  over the year \nggplot(milk_region_data,aes(x=region,y=milk_produced,color=year))+\n        geom_jitter()+ coord_flip()+\n        xlab(\"Region\")+ylab(\"Milk Produced (in 10^6)\")+\n        ggtitle(\"Total Milk Produced by Year in All Regions\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Summation by region for jitter-1.png){width=1152}\n:::\n:::\n\n\nBelow is the same graph with points animated by year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Region wise total milk production changing  over the year animated\np<-ggplot(milk_region_data,aes(x=region,y=milk_produced,color=year))+\n        geom_jitter()+ coord_flip()+\n        xlab(\"Region\")+ylab(\"Milk Produced (in 10^6)\")+\n        ggtitle(\"Total Milk Produced for All Regions for Year: {frame_time}\")+\n        transition_time(year)+ease_aes(\"linear\")+shadow_mark()\n        \nanimate(p,nframes=48,fps=1)        \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Summation by region for jitter by year animation-1.gif)\n:::\n:::\n\n\n## Averaging Regions Considering All the States Over the Years \n\nIf we consider the same approach but for the average of each region we \ncan develop the same two plots. Here also we can see the same variation\nand centering for points for the same regions over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subsetting by average\nmilk_region_data_new<-rbind.data.frame(by_region_sum(1970,F),by_region_sum(1971,F),\n                                   by_region_sum(1972,F),by_region_sum(1973,F),\n                                   by_region_sum(1974,F),by_region_sum(1975,F),\n                                   by_region_sum(1976,F),by_region_sum(1977,F),\n                                   by_region_sum(1978,F),by_region_sum(1979,F),\n                                   by_region_sum(1980,F),by_region_sum(1981,F),\n                                   by_region_sum(1982,F),by_region_sum(1983,F),                   \n                                   by_region_sum(1984,F),by_region_sum(1985,F),               \n                                   by_region_sum(1986,F),by_region_sum(1987,F),                 \n                                   by_region_sum(1988,F),by_region_sum(1989,F),\n                                   by_region_sum(1990,F),by_region_sum(1991,F), \n                                   by_region_sum(1992,F),by_region_sum(1993,F), \n                                   by_region_sum(1994,F),by_region_sum(1995,F), \n                                   by_region_sum(1996,F),by_region_sum(1997,F), \n                                   by_region_sum(1998,F),by_region_sum(1999,F), \n                                   by_region_sum(2000,F),by_region_sum(2001,F),\n                                   by_region_sum(2002,F),by_region_sum(2003,F),   \n                                   by_region_sum(2004,F),by_region_sum(2005,F),                 \n                                   by_region_sum(2006,F),by_region_sum(2007,F), \n                                   by_region_sum(2008,F),by_region_sum(2009,F),\n                                   by_region_sum(2010,F),by_region_sum(2011,F),\n                                   by_region_sum(2012,F),by_region_sum(2013,F),\n                                   by_region_sum(2014,F),by_region_sum(2015,F),\n                                   by_region_sum(2016,F),by_region_sum(2017,F)                  \n                                   )\n```\n:::\n\n\nBelow is the plot for the average of regions over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Region wise average milk production changing  over the year \nggplot(milk_region_data_new,aes(x=region,y=milk_produced,color=year))+\n        geom_jitter()+ coord_flip()+ \n        xlab(\"Region\")+ylab(\"Milk Produced (in 10^6)\")+\n        ggtitle(\"Average Milk Produced by Year in All Regions\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/average by region for jitter-1.png){width=1152}\n:::\n:::\n\n\nThe same plot is now animated for each year and all regions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Region wise average milk production changing  over the year animated\np<-ggplot(milk_region_data_new,aes(x=region,y=milk_produced,color=year))+\n        geom_jitter()+ coord_flip()+\n        transition_time(year)+ease_aes(\"linear\")+ shadow_mark()+       \n        xlab(\"Region\")+ylab(\"Milk Produced (in 10^6)\")+\n        ggtitle(\"Average Milk Produced for All Regions for Year: {frame_time}\")+\n        transition_time(year)+ease_aes(\"linear\")\n        \nanimate(p,nframes=48,fps=1)        \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/average by region for jitter by year animation-1.gif)\n:::\n\n```{.r .cell-code}\ndetach(state_milk_production)\n```\n:::\n\n\n# Cheese\n\n16 types of cheese are provided in this clean cheese data-set. I will divide these types into \n3 types and will not consider few types of cheese. The unit of measurement for the consumption is lbs per person.\n\n## Cheese with Other\n\nI am going to consider the types American Other, Italian Other and Swiss for this plot.\nRed color indicates to American Other, yellow color refers to Italian other and blue for Swiss.\nAlot of fluctuation for American other type, but this is not the case for Swiss type cheese. \nThere is steady increase for the Italian other type cheese over the years. All of these \nare less than 4 lbs per person and it is animated.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 3 types of cheese change per person over the year in lbs\np<-ggplot(clean_cheese,aes(x=factor(Year)))+ \n          geom_point(aes(y=`American Other`),stat=\"identity\",color=\"red\")+\n          geom_point(aes(y=`Italian other`),stat=\"identity\",color=\"yellow\")+\n          geom_point(aes(y=Swiss),stat=\"identity\",color=\"blue\")+\n          transition_time(Year)+\n          theme(axis.text.x =element_text(angle = 90, hjust = 1))+\n          xlab(\"Year\")+ylab(\"Consumption in lbs per person\")+\n          ggtitle(\"Cheese Consumption Over the Years\")+\n          ease_aes(\"linear\")+shadow_mark()\n\nanimate(p,nframes=48,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Cheese with other-1.gif)\n:::\n:::\n\n\n## Cheese with Total\n\nThis is also an animated plot but for the cheese types which has the word Total. They are \nTotal American Cheese, Total Italian Cheese, Total Natural Cheese and Total Processed Cheese\nProducts with the colors represented respectively red, yellow, blue and green.\n\nAll the Consumption units are in between 0 to 40 lbs per person. Clearly Total Natural Cheese has \na steady amount of increase from 1970(slightly above 10) to 2017(approximately less than 40). \nConsidering the other three types we can see it is not the same order that it is in 1970 over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 4 types of cheese change per person over the year in lbs\np<-ggplot(clean_cheese,aes(x=factor(Year)))+ \n          geom_point(aes(y=`Total American Chese`),stat=\"identity\",color=\"red\")+\n          geom_point(aes(y=`Total Italian Cheese`),stat=\"identity\",color=\"yellow\")+\n          geom_point(aes(y=`Total Natural Cheese`),stat=\"identity\",color=\"blue\")+\n          geom_point(aes(y=`Total Processed Cheese Products`),stat=\"identity\",color=\"green\")+\n          xlab(\"Year\")+ylab(\"Consumption in lbs per person\")+\n          theme(axis.text.x =element_text(angle = 90, hjust = 1))+  \n          ggtitle(\"Cheese Consumption Over the Years\")+\n          transition_time(Year)+ \n          ease_aes(\"linear\")+shadow_mark()\n\nanimate(p,nframes=48,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Cheese with Total-1.gif)\n:::\n:::\n\n\n## Cheese with known Type Names\n\nNext group of cheese types include Cheddar, Mozzarella, Brick, Processed Cheese and Foods & spreads for the \ncolors representing respectively red, yellow, blue, green and white. Clearly Cheddar and mozzarella type cheese are\nare mostly consumed by 2017 above 10 lbs per person, but this is not the case in 1970 where consumption\nis less than 6 lbs per person. \n\nWell Processed Cheese and Foods & Spreads have changed very small over the years. The consumption\nis always less than 6 lbs per person. This is not the case for Brick type cheese where the consumption\nis close to zero over the years from 1970 until 2017.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 5 types of cheese change per person over the year in lbs\np<-ggplot(clean_cheese,aes(x=factor(Year)))+ \n          geom_point(aes(y=Cheddar),stat=\"identity\",color=\"red\")+\n          geom_point(aes(y=Mozzarella),stat=\"identity\",color=\"yellow\")+\n          geom_point(aes(y=`Brick`),stat=\"identity\",color=\"blue\")+\n          geom_point(aes(y=`Processed Cheese`),stat=\"identity\",color=\"green\")+\n          geom_point(aes(y=`Foods and spreads`),stat=\"identity\",color=\"white\")+\n          xlab(\"Year\")+ylab(\"Consumption in lbs per person\")+\n          theme(axis.text.x =element_text(angle = 90, hjust = 1))+\n          ggtitle(\"Cheese Consumption Over the Years\")+\n          transition_time(Year)+ \n          ease_aes(\"linear\")+shadow_mark()\n\nanimate(p,nframes=48,fps=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Cheese with known-1.gif)\n:::\n:::\n\n\n*THANK YOU*\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}